webpackJsonp([6],{hWYy:function(t,e){},jPG2:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s("Dd8w"),i=s.n(r),a=s("NYxO"),n=s("Cz8s"),o=s("mzkE"),d=s("snFw"),l=s("nZVv"),c={components:{publicHeader:n.a,publicFooter:o.a,orderItem:d.a},data:function(){return{showPreLoading:!0,isRefresh:!1,filter:{items:{status:1,refund_status:0}},orders:{page:1,psize:15,finished:!1,loading:!1,data:[]},menufooter:{}}},methods:i()({},Object(a.b)(["setSearch"]),{onChangeStatus:function(t){var e=!1;t!=this.filter.items.status&&(e=!0),this.filter.items.status=t,this.filter.items.refund_status=0,6==t&&(this.filter.items.refund_status=1),this.onLoad(e)},onLoad:function(t){Object(l.b)({vue:this,force:t,data:{filter:this.filter?this.filter.items:{},menufooter:1}})},onPullDownRefresh:function(){this.onLoad(!0)},onChangeOrderStatus:function(t){t.vue=this,Object(l.a)(t)},onSetSearch:function(){this.setSearch({title:"订单搜索",type:"filter",key:"takeout",url:"plateform/order/takeout/search",redirctUrl:"pages/order/searchResult"}),this.$router.push(this.util.getUrl({path:"/pages/common/search"}))},onPushUUPaotui:function(t){t.vue=this,Object(l.c)(t)}}),mounted:function(){var t=this;!t.util.getStorage("iptoken")&&t.util.isPlala()?window.apiready=function(){var e=api.getPrefs({sync:!0,key:"iptoken"});e&&t.util.setStorage("iptoken",e),t.onLoad(!1)}:t.onLoad(!1),t.util.imap(),t.util.icloudapi()},created:function(){this.query=this.$route.query,this.query&&this.query.status&&(this.filter.items.status=this.query.status)}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"takeout"}},[s("public-header",{attrs:{title:"订单列表"}},[s("div",{staticClass:"search-btn",attrs:{slot:"right"},on:{click:function(e){t.onSetSearch()}},slot:"right"},[s("span",{staticClass:"icon icon-search"})])]),t._v(" "),s("public-footer",{attrs:{menufooter:t.menufooter,showPreLoading:t.showPreLoading}}),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"tab-group flex-lr border-1px-b"},[s("div",{staticClass:"tab-item",class:{active:1==t.filter.items.status},on:{click:function(e){t.onChangeStatus(1)}}},[t._v("待接单")]),t._v(" "),s("div",{staticClass:"tab-item",class:{active:2==t.filter.items.status},on:{click:function(e){t.onChangeStatus(2)}}},[t._v("已确认")]),t._v(" "),s("div",{staticClass:"tab-item",class:{active:3==t.filter.items.status},on:{click:function(e){t.onChangeStatus(3)}}},[t._v("待配送")]),t._v(" "),s("div",{staticClass:"tab-item",class:{active:4==t.filter.items.status},on:{click:function(e){t.onChangeStatus(4)}}},[t._v("配送中")]),t._v(" "),s("div",{staticClass:"tab-item",class:{active:6==t.filter.items.status},on:{click:function(e){t.onChangeStatus(6)}}},[t._v("退款单")])]),t._v(" "),s("van-pull-refresh",{on:{refresh:t.onPullDownRefresh},model:{value:t.isRefresh,callback:function(e){t.isRefresh=e},expression:"isRefresh"}},[t.orders.empty?s("div",{staticClass:"no-data"},[s("img",{attrs:{src:"static/img/order_no_con.png",alt:""}}),t._v(" "),s("p",[t._v("暂无订单!")])]):s("van-list",{staticClass:"order-list",attrs:{finished:t.orders.finished,offset:100,"immediate-check":!1},on:{load:t.onLoad},model:{value:t.orders.loading,callback:function(e){t.$set(t.orders,"loading",e)},expression:"orders.loading"}},[t._l(t.orders.data,function(e,r){return[s("order-item",{attrs:{order:e,order_index:r},on:{onChangeOrderStatus:t.onChangeOrderStatus,onPushUU:t.onPushUUPaotui}})]})],2)],1)],1)],1)},staticRenderFns:[]};var _=s("VU/8")(c,u,!1,function(t){s("nTm4")},null,null);e.default=_.exports},nTm4:function(t,e){},snFw:function(t,e,s){"use strict";var r={props:{order:Object,order_index:Number},data:function(){return{isRefresh:!1}},components:{},methods:{onChangeOrderStatus:function(t,e,s){var r={order:t,type:e,index:s};this.$emit("onChangeOrderStatus",r)},onPushUU:function(t){this.$emit("onPushUU",{orderId:t})}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"order-item"}},[s("div",{staticClass:"order-item"},[s("div",{staticClass:"number-price flex-lr border-1px-b"},[s("div",{staticClass:"number"},[t._v("#"+t._s(t.order.serial_sn))]),t._v(" "),s("div",{staticClass:"price"},[t._v("¥"+t._s(t.order.final_fee))])]),t._v(" "),s("router-link",{staticClass:"order-detail",attrs:{tag:"div",to:t.util.getUrl({path:"pages/order/detail",query:{id:t.order.id}})}},[s("div",{staticClass:"detail-item buy-address flex-lr"},[s("div",{staticClass:"left c-info"},[t._v("取货")]),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"store-title ellipsis"},[t._v("\n\t\t\t\t\t\t"+t._s(t.order.store.title)+"\n\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"store-address ellipsis"},[t._v("\n\t\t\t\t\t\t"+t._s(t.order.store.address)+"\n\t\t\t\t\t")])])]),t._v(" "),s("div",{staticClass:"detail-item accept-address flex-lr"},[s("div",{staticClass:"left c-primary"},[t._v("送货")]),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"store-title"},[t._v("\n\t\t\t\t\t\t"+t._s(t.order.address)+"\n\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"store-address"},[t._v("\n\t\t\t\t\t\t"+t._s(t.order.username)+" "+t._s(t.order.mobile)+"\n\t\t\t\t\t")])])]),t._v(" "),t.order.deliveryer_id>0&&t.order.deliveryer?s("div",{staticClass:"detail-item flex-lr"},[s("div",{staticClass:"left c-danger"},[t._v("配送:")]),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"store-title"},[t._v("\n\t\t\t\t\t\t"+t._s(t.order.deliveryer.title)+" "+t._s(t.order.deliveryer.mobile)+"\n\t\t\t\t\t")]),t._v(" "),7==t.order.delivery_status?s("div",{staticClass:"store-address"},[t._v("\n\t\t\t\t\t\t已接单 (接单时间："+t._s(t.order.delivery_assign_time_cn)+")\n\t\t\t\t\t")]):8==t.order.delivery_status?s("div",{staticClass:"store-address"},[t._v("\n\t\t\t\t\t\t已到店 (到店时间："+t._s(t.order.delivery_instore_time_cn)+")\n\t\t\t\t\t")]):4==t.order.delivery_status?s("div",{staticClass:"store-address"},[t._v("\n\t\t\t\t\t\t已取货 (取货时间："+t._s(t.order.delivery_takegoods_time_cn)+")\n\t\t\t\t\t")]):5==t.order.delivery_status?s("div",{staticClass:"store-address"},[t._v("\n\t\t\t\t\t\t已送达 (送达时间："+t._s(t.order.delivery_success_time_cn)+")\n\t\t\t\t\t")]):t._e()])]):t._e(),t._v(" "),s("div",{staticClass:"detail-item note flex-lr"},[s("div",{staticClass:"left"},[t._v("备注")]),t._v(" "),s("div",{staticClass:"right"},[t._v(t._s(t.order.note?t.order.note:"无"))])]),t._v(" "),s("div",{staticClass:"detail-item flex-lr"},[s("div",{staticClass:"left"},[t._v("下单")]),t._v(" "),s("div",{staticClass:"right"},[t._v(t._s(t.order.addtime_cn))])]),t._v(" "),s("div",{staticClass:"detail-item flex-lr"},[s("div",{staticClass:"left"},[t._v("配送")]),t._v(" "),s("div",{staticClass:"right"},[t._v(t._s(t.order.delivery_day)+" "+t._s(t.order.delivery_time))])])]),t._v(" "),t.order.status<5||1==t.order.refund_status||2==t.order.refund_status?s("ul",{staticClass:"btn-group border-1px-t"},[t.order.status<5?[1==t.order.status?[s("li",{staticClass:"btn-item",on:{click:function(e){t.onChangeOrderStatus(t.order,"notify_clerk_handle",t.order_index)}}},[t._v("通知商户")]),t._v(" "),s("li",{staticClass:"btn-item btn-primary",on:{click:function(e){t.onChangeOrderStatus(t.order,"handle",t.order_index)}}},[t._v("接单")])]:t._e(),t._v(" "),1==t.order.order_type?[2==t.order.status||3==t.order.status?[s("li",{staticClass:"btn-item",on:{click:function(e){t.onChangeOrderStatus(t.order,"notify_deliveryer_collect",t.order_index)}}},[t._v("通知抢单")]),t._v(" "),2==t.order.delivery_type?s("router-link",{staticClass:"btn-item",attrs:{tag:"li",to:t.util.getUrl({path:"pages/order/dispatch",query:{id:t.order.id}})}},[t._v("调度")]):t._e(),t._v(" "),t.order.uupaotui_status&&2==t.order.delivery_type?s("li",{staticClass:"btn-item",on:{click:function(e){t.onPushUU(t.order.id)}}},[t._v("UU配送")]):t._e()]:t._e(),t._v(" "),4==t.order.status?[s("li",{staticClass:"btn-item",on:{click:function(e){t.onChangeOrderStatus(t.order,"re_notify_deliveryer_collect",t.order_index)}}},[t._v("重新待抢")]),t._v(" "),s("router-link",{staticClass:"btn-item",attrs:{tag:"li",to:t.util.getUrl({path:"pages/order/dispatch",query:{id:t.order.id}})}},[t._v("重新调度")])]:t._e(),t._v(" "),t.order.status>1?[s("li",{staticClass:"btn-item",on:{click:function(e){t.onChangeOrderStatus(t.order,"end",t.order_index)}}},[t._v("完成")])]:t._e()]:[s("li",{staticClass:"btn-item",on:{click:function(e){t.onChangeOrderStatus(t.order,"end",t.order_index)}}},[t._v("完成")])],t._v(" "),1==t.order.is_pay&&"delivery"!=t.order.pay_type?[s("li",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"cancel_refund",t.order_index)}}},[t._v("取消")])]:[s("li",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"cancel",t.order_index)}}},[t._v("取消")])]]:t._e(),t._v(" "),1==t.order.refund_status?[s("li",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"refund_handle",t.order_index)}}},[t._v("发起退款")]),t._v(" "),s("li",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"refund_status",t.order_index)}}},[t._v("已退款")])]:2==t.order.refund_status?[s("li",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"refund_query",t.order_index)}}},[t._v("查询退款")]),t._v(" "),s("li",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"refund_status",t.order_index)}}},[t._v("已退款")])]:t._e()],2):t._e()],1)])},staticRenderFns:[]};var a=s("VU/8")(r,i,!1,function(t){s("hWYy")},null,null);e.a=a.exports}});