webpackJsonp([6],{"+TmT":function(t,e,o){"use strict";var s=o("mtWM"),i=o.n(s),a={name:"Uploader",props:{value:{type:Array,default:function(){return[]}},max:{type:Number|String,default:0},uploadOptions:{type:Object,default:function(){return{type:"h5",dock:"utility/upload"}}}},methods:{onDel:function(t){this.value.splice(t,1),this.$emit("delete",this.value)},onUpload:function(t,e){var o=this;if("h5"==o.uploadOptions.type){if(!e)return;var s=e.target;if(s.files&&s.files.length>0){var a=o.util.getFullUrl("c=utility&a=file&do=upload&type=image&thumb=0");o.$toast.loading({message:"上传中",duration:0});for(var n=0;n<s.files.length;n++){var r=new FormData;r.append("file",s.files[n]),i.a.post(a,r).then(function(e){o.$toast.clear();var s=e.data;s.errno?s.message?alert("上传文件失败, 具体原因:"+s.message):alert("上传文件失败, 具体原因:"+s.error.message):s.url&&s.filename&&(t>0?o.value[t]={url:s.url,filename:s.filename}:o.value.push({url:s.url,filename:s.filename}),console.log(o.value),o.$emit("onGetUrl",o.value))})}}}}}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"uploader"},[o("van-row",{staticClass:"weui-uploader__files",attrs:{gutter:"10"}},[t._l(t.value,function(e,s){return o("van-col",{key:s,attrs:{span:"6"}},[o("div",{staticClass:"weui-uploader__file",style:{backgroundImage:"url("+e.url+")"}},[o("i",{staticClass:"icon icon-close",on:{click:function(e){t.onDel(s)}}})])])}),t._v(" "),t.max>0&&t.value.length<t.max||t.max<=0?o("van-col",{staticClass:"weui-uploader__input-box",attrs:{span:"6"}},[o("div",{staticClass:"weui-uploader__file"},["h5"==t.uploadOptions.type?o("input",{staticClass:"weui-uploader__input",attrs:{type:"file",multiple:"multiple",accept:"image/*"},on:{change:function(e){t.onUpload(-1,e)}}}):t._e(),t._v(" "),t._t("img",[o("i",{staticClass:"icon icon-camerafill"})])],2)]):t._e()],2)],1)},staticRenderFns:[]};var r=o("VU/8")(a,n,!1,function(t){o("yt8p")},null,null);e.a=r.exports},CaDF:function(t,e){},MXID:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("mvHQ"),i=o.n(s),a=o("Gu7T"),n=o.n(a),r=o("Cz8s"),l=o("+TmT"),c=o("deIj"),u={data:function(){return{timePickerShow:!1,id:"",type:"title",store:{title:"",logo:"",content:"",business_hours:[],telephone:"",address:"",thumbs:[],cid:"",category_arr:{},category_cn1:"",category_cn2:"",notice:"",tips:""},popupStatus:{category:!1},categorys:[],changeCategoryType:0,columns:[{values:[],defaultIndex:0},{values:[],defaultIndex:0}],businessHoursSelected:{index:0,type:"s"},logo:[],thumbs:[],islegal:!1,showPreLoading:!0}},components:{publicHeader:r.a,uploader:l.a},methods:{onToggleCategoryType:function(t){this.changeCategoryType=t,this.onTogglePopup("category")},onTogglePopup:function(t){this.popupStatus[t]=!this.popupStatus[t]},onConfirmCategory:function(t){var e="cate_parentid"+this.changeCategoryType,o="cate_childid"+this.changeCategoryType,s="category_cn"+this.changeCategoryType;t[1]?(this.store.category_arr[e]=t[1].parentid,this.store.category_arr[o]=t[1].id,this.store[s]=t[0].title+"-"+t[1].title):(this.store.category_arr[e]=t[0].id,this.store.category_arr[o]=0,this.store[s]=t[0].title),this.onTogglePopup("category")},onChangeCategory:function(t,e){e[0].child&&e[0].child.length>0?t.setColumnValues(1,e[0].child):t.setColumnValues(1,[])},onToggleTimePicker:function(t,e){this.timePickerShow=!this.timePickerShow,t>-1&&("s"==e||"e"==e)&&(this.businessHoursSelected.index=t,this.businessHoursSelected.type=e)},onConfirmTime:function(t){if(t){var e=this.businessHoursSelected.index,o=this.businessHoursSelected.type;this.store.business_hours[e][o]=t,this.onToggleTimePicker()}},onAddTime:function(){return"business_hours"==this.type&&(this.store.business_hours.length>=3?(this.util.$toast("最多可添加三个营业时间段"),!1):void this.store.business_hours.push({s:"08:00",e:"21:00"}))},onRemoveTime:function(t){if("business_hours"!=this.type)return!1;this.store.business_hours.splice(t,1)},onToggleCategory:function(t,e){this.$refs.checkboxes[e].toggle()},onChangeLogo:function(t){var e="";t&&1==t.length&&t[0].filename&&(e=t[0].filename),this.store.logo=e},onChangeThumbs:function(t){var e=[];if(t&&t.length>0)for(var o in t)e.push({image:t[o].url,url:""});this.store.thumbs=e},onLoad:function(){var t=this;Object(c.a)({url:"plateform/store/shop/setting",vue:t,autoAssign:!0,variable:"store",data:{id:t.id,type:t.type},success:function(e){if(t.islegal=!0,"cid"==t.type){var o=e.categorys;if(!(o&&o.length>0))return t.util.$toast("平台暂未设置商户分类",t.util.getUrl({path:"pages/merchant/store/basic",query:{id:t.id}}),2e3,"replace"),!1;t.columns[0].values=o,t.columns[0].values[0].child&&(t.columns[1].values=o[0].child),t.columns=[].concat(n()(t.columns))}else if("logo"==t.type)t.store.logo&&t.logo.push({url:t.store.logo});else if("thumbs"==t.type&&t.store.thumbs&&t.store.thumbs.length>0)for(var s in t.store.thumbs)t.thumbs.push({url:t.store.thumbs[s].image})}})},onSubmit:function(){var t=this;if(!t.islegal)return!1;t.islegal=!1;var e=t.store[t.type];"cid"==t.type&&(e=t.store.category_arr);var o="pages/merchant/store/basic";"notice"!=t.type&&"tips"!=t.type||(o="pages/merchant/store/index"),Object(c.c)({url:"plateform/store/shop/setting",vue:t,data:{id:t.id,type:t.type,value:i()(e)},redirect:t.util.getUrl({path:o,query:{id:t.id}}),fail:function(e){t.util.$toast(e),t.islegal=!0}})}},created:function(){this.$route.query&&(this.$route.query.type&&(this.type=this.$route.query.type),this.$route.query.id&&(this.id=this.$route.query.id))},mounted:function(){this.onLoad()}},p={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"store-update"}},[o("public-header",{attrs:{title:"基本信息设置"}}),t._v(" "),o("div",{staticClass:"content"},["title"==t.type?o("van-cell-group",[o("van-field",{attrs:{label:"门店名称",placeholder:"请输入门店名称","input-align":"right"},model:{value:t.store.title,callback:function(e){t.$set(t.store,"title",e)},expression:"store.title"}})],1):"telephone"==t.type?o("van-cell-group",[o("van-field",{attrs:{label:"联系电话",placeholder:"请输入门店联系电话","input-align":"right"},model:{value:t.store.telephone,callback:function(e){t.$set(t.store,"telephone",e)},expression:"store.telephone"}})],1):"address"==t.type?o("van-cell-group",[o("van-field",{attrs:{label:"门店地址",placeholder:"请输入门店地址","input-align":"right"},model:{value:t.store.address,callback:function(e){t.$set(t.store,"address",e)},expression:"store.address"}})],1):"content"==t.type?[o("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[t._v("门店描述")]),t._v(" "),o("van-cell-group",[o("van-field",{attrs:{type:"textarea",rows:"3",autosize:"",placeholder:"请输入门店描述"},model:{value:t.store.content,callback:function(e){t.$set(t.store,"content",e)},expression:"store.content"}})],1)]:t._e(),t._v(" "),"cid"==t.type?[o("van-cell",{attrs:{title:"主营分类"}},[o("div",{attrs:{slot:"right-icon"},on:{click:function(e){t.onToggleCategoryType(1)}},slot:"right-icon"},[o("span",[t._v(t._s(t.store.category_cn1?t.store.category_cn1:"选择主营分类"))]),t._v(" "),o("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),o("van-cell",{attrs:{title:"辅营分类"}},[o("div",{attrs:{slot:"right-icon"},on:{click:function(e){t.onToggleCategoryType(2)}},slot:"right-icon"},[o("span",[t._v(t._s(t.store.category_cn2?t.store.category_cn2:"选择辅营分类"))]),t._v(" "),o("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),o("van-popup",{attrs:{position:"bottom"},model:{value:t.popupStatus.category,callback:function(e){t.$set(t.popupStatus,"category",e)},expression:"popupStatus.category"}},[o("van-picker",{attrs:{"show-toolbar":"",title:"所属分类",columns:t.columns,"value-key":"title"},on:{cancel:function(e){t.onTogglePopup("category")},confirm:t.onConfirmCategory,change:t.onChangeCategory}})],1)]:"notice"==t.type?[o("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[t._v("商户公告")]),t._v(" "),o("van-cell-group",[o("van-field",{attrs:{type:"textarea",rows:"3",autosize:"",placeholder:"请输入商户公告"},model:{value:t.store.notice,callback:function(e){t.$set(t.store,"notice",e)},expression:"store.notice"}})],1)]:"tips"==t.type?[o("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[t._v("商品列表页提示")]),t._v(" "),o("van-cell-group",[o("van-field",{attrs:{type:"textarea",rows:"3",autosize:"",placeholder:"用户进入页面后, 将弹框提示设置的内容"},model:{value:t.store.tips,callback:function(e){t.$set(t.store,"tips",e)},expression:"store.tips"}})],1)]:"business_hours"==t.type?[o("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[t._v("营业时间")]),t._v(" "),o("van-cell-group",t._l(t.store.business_hours,function(e,s){return o("van-cell",{key:s},[o("div",{attrs:{slot:"title"},slot:"title"},[o("span",{on:{click:function(e){t.onToggleTimePicker(s,"s")}}},[t._v(t._s(e.s))]),t._v(" "),o("span",{staticClass:"padding-10-lr"},[t._v("至")]),t._v(" "),o("span",{on:{click:function(e){t.onToggleTimePicker(s,"e")}}},[t._v(t._s(e.e))])]),t._v(" "),o("div",{staticClass:"c-primary",attrs:{slot:"right-icon"},on:{click:function(e){t.onRemoveTime(s)}},slot:"right-icon"},[t._v("移除")])])})),t._v(" "),o("van-cell-group",{class:{"margin-10-t":t.store.business_hours.length>0}},[o("van-cell",[o("div",{staticClass:"c-primary",attrs:{slot:"title"},on:{click:t.onAddTime},slot:"title"},[o("i",{staticClass:"icon icon-roundadd font-16"}),t._v("添加时间段\n\t\t\t\t\t\t")])])],1),t._v(" "),o("van-popup",{attrs:{position:"bottom"},model:{value:t.timePickerShow,callback:function(e){t.timePickerShow=e},expression:"timePickerShow"}},[o("van-datetime-picker",{attrs:{type:"time"},on:{confirm:t.onConfirmTime,cancel:t.onToggleTimePicker}})],1)]:"logo"==t.type?[o("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[t._v("门店Logo")]),t._v(" "),o("uploader",{attrs:{max:"1",value:t.logo},on:{onGetUrl:t.onChangeLogo,delete:t.onChangeLogo}})]:"thumbs"==t.type?[o("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[t._v("门店实景")]),t._v(" "),o("uploader",{attrs:{max:"7",value:t.thumbs},on:{onGetUrl:t.onChangeThumbs,delete:t.onChangeThumbs}})]:t._e(),t._v(" "),o("div",{staticClass:"padding-15"},[o("van-button",{attrs:{size:"normal",type:"primary",disabled:!t.islegal,block:""},on:{click:t.onSubmit}},[t._v("保存修改")])],1)],2),t._v(" "),t.showPreLoading?o("iloading"):t._e()],1)},staticRenderFns:[]};var d=o("VU/8")(u,p,!1,function(t){o("CaDF")},"data-v-11795fcc",null);e.default=d.exports},yt8p:function(t,e){}});