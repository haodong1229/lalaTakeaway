webpackJsonp([2],{"+TmT":function(e,t,s){"use strict";var i=s("mtWM"),o=s.n(i),a={name:"Uploader",props:{value:{type:Array,default:function(){return[]}},max:{type:Number|String,default:0},uploadOptions:{type:Object,default:function(){return{type:"h5",dock:"utility/upload"}}}},methods:{onDel:function(e){this.value.splice(e,1),this.$emit("delete",this.value)},onUpload:function(e,t){var s=this;if("h5"==s.uploadOptions.type){if(!t)return;var i=t.target;if(i.files&&i.files.length>0){var a=s.util.getFullUrl("c=utility&a=file&do=upload&type=image&thumb=0");s.$toast.loading({message:"上传中",duration:0});for(var n=0;n<i.files.length;n++){var r=new FormData;r.append("file",i.files[n]),o.a.post(a,r).then(function(t){s.$toast.clear();var i=t.data;i.errno?i.message?alert("上传文件失败, 具体原因:"+i.message):alert("上传文件失败, 具体原因:"+i.error.message):i.url&&i.filename&&(e>0?s.value[e]={url:i.url,filename:i.filename}:s.value.push({url:i.url,filename:i.filename}),console.log(s.value),s.$emit("onGetUrl",s.value))})}}}}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"uploader"},[s("van-row",{staticClass:"weui-uploader__files",attrs:{gutter:"10"}},[e._l(e.value,function(t,i){return s("van-col",{key:i,attrs:{span:"6"}},[s("div",{staticClass:"weui-uploader__file",style:{backgroundImage:"url("+t.url+")"}},[s("i",{staticClass:"icon icon-close",on:{click:function(t){e.onDel(i)}}})])])}),e._v(" "),e.max>0&&e.value.length<e.max||e.max<=0?s("van-col",{staticClass:"weui-uploader__input-box",attrs:{span:"6"}},[s("div",{staticClass:"weui-uploader__file"},["h5"==e.uploadOptions.type?s("input",{staticClass:"weui-uploader__input",attrs:{type:"file",multiple:"multiple",accept:"image/*"},on:{change:function(t){e.onUpload(-1,t)}}}):e._e(),e._v(" "),e._t("img",[s("i",{staticClass:"icon icon-camerafill"})])],2)]):e._e()],2)],1)},staticRenderFns:[]};var r=s("VU/8")(a,n,!1,function(e){s("kMrQ")},null,null);t.a=r.exports},MXID:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("mvHQ"),o=s.n(i),a=s("Gu7T"),n=s.n(a),r=s("Cz8s"),l=s("+TmT"),c=s("deIj"),u={data:function(){return{timePickerShow:!1,id:"",type:"title",store:{title:"",logo:"",content:"",business_hours:[],telephone:"",address:"",thumbs:[],cid:"",category_arr:[],notice:"",tips:""},categorys:[],businessHoursSelected:{index:0,type:"s"},logo:[],thumbs:[],islegal:!1,showPreLoading:!0}},components:{publicHeader:r.a,uploader:l.a},methods:{onToggleTimePicker:function(e,t){this.timePickerShow=!this.timePickerShow,e>-1&&("s"==t||"e"==t)&&(this.businessHoursSelected.index=e,this.businessHoursSelected.type=t)},onConfirmTime:function(e){if(e){var t=this.businessHoursSelected.index,s=this.businessHoursSelected.type;this.store.business_hours[t][s]=e,this.onToggleTimePicker()}},onAddTime:function(){return"business_hours"==this.type&&(this.store.business_hours.length>=3?(this.util.$toast("最多可添加三个营业时间段"),!1):void this.store.business_hours.push({s:"08:00",e:"21:00"}))},onRemoveTime:function(e){if("business_hours"!=this.type)return!1;this.store.business_hours.splice(e,1)},onToggleCategory:function(e,t){this.$refs.checkboxes[t].toggle()},onChangeLogo:function(e){var t="";e&&1==e.length&&e[0].filename&&(t=e[0].filename),this.store.logo=t},onChangeThumbs:function(e){var t=[];if(e&&e.length>0)for(var s in e)t.push({image:e[s].url,url:""});this.store.thumbs=t},onLoad:function(){var e=this;Object(c.a)({url:"plateform/store/shop/setting",vue:e,autoAssign:!0,variable:"store",data:{id:e.id,type:e.type},success:function(t){if(e.islegal=!0,"cid"==e.type){var s=t.categorys;if(!(s&&s.length>0))return e.util.$toast("平台暂未设置商户分类",e.util.getUrl({path:"pages/merchant/store/basic",query:{id:e.id}}),2e3,"replace"),!1;e.categorys=[].concat(n()(e.categorys),n()(s))}else if("logo"==e.type)e.store.logo&&e.logo.push({url:e.store.logo});else if("thumbs"==e.type&&e.store.thumbs&&e.store.thumbs.length>0)for(var i in e.store.thumbs)e.thumbs.push({url:e.store.thumbs[i].image})}})},onSubmit:function(){var e=this;if(!e.islegal)return!1;e.islegal=!1;var t=e.store[e.type];"cid"==e.type&&(t=e.store.category_arr);var s="pages/merchant/store/basic";"notice"!=e.type&&"tips"!=e.type||(s="pages/merchant/store/index"),Object(c.c)({url:"plateform/store/shop/setting",vue:e,data:{id:e.id,type:e.type,value:o()(t)},redirect:e.util.getUrl({path:s,query:{id:e.id}}),fail:function(t){e.util.$toast(t),e.islegal=!0}})}},created:function(){this.$route.query&&(this.$route.query.type&&(this.type=this.$route.query.type),this.$route.query.id&&(this.id=this.$route.query.id))},mounted:function(){this.onLoad()}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"store-update"}},[s("public-header",{attrs:{title:"基本信息设置"}}),e._v(" "),s("div",{staticClass:"content"},["title"==e.type?s("van-cell-group",[s("van-field",{attrs:{label:"门店名称",placeholder:"请输入门店名称","input-align":"right"},model:{value:e.store.title,callback:function(t){e.$set(e.store,"title",t)},expression:"store.title"}})],1):"telephone"==e.type?s("van-cell-group",[s("van-field",{attrs:{label:"联系电话",placeholder:"请输入门店联系电话","input-align":"right"},model:{value:e.store.telephone,callback:function(t){e.$set(e.store,"telephone",t)},expression:"store.telephone"}})],1):"address"==e.type?s("van-cell-group",[s("van-field",{attrs:{label:"门店地址",placeholder:"请输入门店地址","input-align":"right"},model:{value:e.store.address,callback:function(t){e.$set(e.store,"address",t)},expression:"store.address"}})],1):"content"==e.type?[s("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[e._v("门店描述")]),e._v(" "),s("van-cell-group",[s("van-field",{attrs:{type:"textarea",rows:"3",autosize:"",placeholder:"请输入门店描述"},model:{value:e.store.content,callback:function(t){e.$set(e.store,"content",t)},expression:"store.content"}})],1)]:e._e(),e._v(" "),"cid"==e.type?[s("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[e._v("所属分类")]),e._v(" "),s("van-checkbox-group",{model:{value:e.store.category_arr,callback:function(t){e.$set(e.store,"category_arr",t)},expression:"store.category_arr"}},[s("van-cell-group",e._l(e.categorys,function(t,i){return s("van-cell",{key:t.id,attrs:{clickable:"",title:t.title},on:{click:function(s){e.onToggleCategory(t.id,i)}}},[s("van-checkbox",{ref:"checkboxes",refInFor:!0,attrs:{name:t.id}})],1)}))],1)]:"notice"==e.type?[s("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[e._v("商户公告")]),e._v(" "),s("van-cell-group",[s("van-field",{attrs:{type:"textarea",rows:"3",autosize:"",placeholder:"请输入商户公告"},model:{value:e.store.notice,callback:function(t){e.$set(e.store,"notice",t)},expression:"store.notice"}})],1)]:"tips"==e.type?[s("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[e._v("商品列表页提示")]),e._v(" "),s("van-cell-group",[s("van-field",{attrs:{type:"textarea",rows:"3",autosize:"",placeholder:"用户进入页面后, 将弹框提示设置的内容"},model:{value:e.store.tips,callback:function(t){e.$set(e.store,"tips",t)},expression:"store.tips"}})],1)]:"business_hours"==e.type?[s("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[e._v("营业时间")]),e._v(" "),s("van-cell-group",e._l(e.store.business_hours,function(t,i){return s("van-cell",{key:i},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",{on:{click:function(t){e.onToggleTimePicker(i,"s")}}},[e._v(e._s(t.s))]),e._v(" "),s("span",{staticClass:"padding-10-lr"},[e._v("至")]),e._v(" "),s("span",{on:{click:function(t){e.onToggleTimePicker(i,"e")}}},[e._v(e._s(t.e))])]),e._v(" "),s("div",{staticClass:"c-primary",attrs:{slot:"right-icon"},on:{click:function(t){e.onRemoveTime(i)}},slot:"right-icon"},[e._v("移除")])])})),e._v(" "),s("van-cell-group",{class:{"margin-10-t":e.store.business_hours.length>0}},[s("van-cell",[s("div",{staticClass:"c-primary",attrs:{slot:"title"},on:{click:e.onAddTime},slot:"title"},[s("i",{staticClass:"icon icon-roundadd font-16"}),e._v("添加时间段\n\t\t\t\t\t")])])],1),e._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:e.timePickerShow,callback:function(t){e.timePickerShow=t},expression:"timePickerShow"}},[s("van-datetime-picker",{attrs:{type:"time"},on:{confirm:e.onConfirmTime,cancel:e.onToggleTimePicker}})],1)]:"logo"==e.type?[s("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[e._v("门店Logo")]),e._v(" "),s("uploader",{attrs:{max:"1",value:e.logo},on:{onGetUrl:e.onChangeLogo,delete:e.onChangeLogo}})]:"thumbs"==e.type?[s("div",{staticClass:"font-14 padding-15-lr padding-10-tb c-gray"},[e._v("门店实景")]),e._v(" "),s("uploader",{attrs:{max:"7",value:e.thumbs},on:{onGetUrl:e.onChangeThumbs,delete:e.onChangeThumbs}})]:e._e(),e._v(" "),s("div",{staticClass:"padding-15"},[s("van-button",{attrs:{size:"normal",type:"primary",disabled:!e.islegal,block:""},on:{click:e.onSubmit}},[e._v("保存修改")])],1)],2),e._v(" "),e.showPreLoading?s("iloading"):e._e()],1)},staticRenderFns:[]};var p=s("VU/8")(u,d,!1,function(e){s("sK8G")},"data-v-5aadcb12",null);t.default=p.exports},kMrQ:function(e,t){},sK8G:function(e,t){}});
//# sourceMappingURL=2.431b7f0c69c8a5e09046.js.map