webpackJsonp([32],{IeHp:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Cz8s"),r=s("nZVv"),a={data:function(){return{showPreLoading:!0,order:{}}},components:{publicHeader:i.a},methods:{onLoad:function(){var t=this;this.util.request({url:"plateform/order/takeout/detail",data:{id:this.$route.query.id}}).then(function(e){t.showPreLoading=!1;var s=e.data.message;s.errno?t.$toast(s.message):t.order=s.message.order})},onChangeOrderStatus:function(t,e){var s={order:t,type:e,from:"detail",vue:this};Object(r.a)(s)},onPushUUPaotui:function(){var t={vue:this,orderId:this.order.id};Object(r.c)(t)}},mounted:function(){this.onLoad()}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"takeout-detail"}},[s("public-header",{attrs:{title:"订单详情"}}),t._v(" "),t.order.log_current?s("div",{staticClass:"content"},[s("router-link",{staticClass:"order-log padding-15 bg-default font-15",attrs:{tag:"div",to:t.util.getUrl({path:"pages/order/log",query:{id:t.order.id}})}},[s("van-row",{staticClass:"flex-lr c-gray"},[s("van-col",{attrs:{span:"2"}},[s("div",{staticClass:"icon icon-waimai font-20 c-primary"})]),t._v(" "),s("van-col",{attrs:{span:"21"}},[s("div",{staticClass:"c-primary"},[t._v(t._s(t.order.log_current.title)+", 操作人: "+t._s(t.order.log_current.role_cn))]),t._v(" "),s("div",{staticClass:"font-13 margin-5-t"},[t._v(t._s(t.order.log_current.addtime_cn))])]),t._v(" "),s("van-col",{attrs:{span:"1"}},[s("div",{staticClass:"icon icon-right "})])],1)],1),t._v(" "),s("div",{staticClass:"tip"},[t._v("订单配送")]),t._v(" "),s("div",{staticClass:"address bg-default"},[t.order.deliveryer_id>0?s("div",{staticClass:"type van-hairline--bottom c-gray"},[t._v(t._s(t.order.delivery_collect_type_cn))]):t._e(),t._v(" "),s("div",{staticClass:"address-detail"},[s("div",{staticClass:"address-item buy flex-lr margin-15-b"},[t._m(0),t._v(" "),t.order.store?s("div",{staticClass:"right"},[s("div",{staticClass:"ellipsis"},[t._v(t._s(t.order.store.title))]),t._v(" "),s("div",{staticClass:"ellipsis margin-10-t c-gray font-14"},[t._v(t._s(t.order.store.address))])]):t._e()]),t._v(" "),s("div",{staticClass:"address-item accept flex-lr"},[t._m(1),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:" ellipsis"},[t._v(t._s(t.order.address))]),t._v(" "),s("div",{staticClass:" ellipsis margin-10-t c-gray font-14"},[t._v(t._s(t.order.username)+" "+t._s(t.order.mobile))])])])])]),t._v(" "),s("div",{staticClass:"telephone flex-lr bg-default margin-10-t padding-10-tb "},[t.order.store?s("div",{staticClass:"tel-item van-hairline--right",on:{click:function(e){t.util.jsTel(t.order.store.telephone)}}},[s("img",{attrs:{src:"static/img/store.png",alt:""}}),t._v(" "),s("span",[t._v(t._s(t.order.store.telephone))])]):t._e(),t._v(" "),s("div",{staticClass:"tel-item",on:{click:function(e){t.util.jsTel(t.order.mobile)}}},[s("img",{attrs:{src:"static/img/customer.png",alt:""}}),t._v(" "),s("span",[t._v(t._s(t.order.mobile))])])]),t._v(" "),t.order.deliveryer_id>0&&t.order.deliveryer?[s("div",{staticClass:"tip"},[t._v("配送员信息")]),t._v(" "),s("van-row",{staticClass:"deliveryer-info bg-default padding-15-lr padding-10-tb flex-lr"},[s("van-col",{attrs:{span:"4"}},[s("img",{attrs:{src:t.order.deliveryer.avatar,alt:""}})]),t._v(" "),s("van-col",{staticClass:"padding-10-l",attrs:{span:"12"}},[s("div",[t._v(t._s(t.order.deliveryer.title))]),t._v(" "),s("div",{staticClass:"c-gray font-14 margin-10-t "},[t._v(t._s(t.order.deliveryer.mobile))])]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"4"}},[s("div",{staticClass:"icon icon-telephone font-18",on:{click:function(e){t.util.jsTel(t.order.deliveryer.mobile)}}})]),t._v(" "),s("van-col",{staticClass:"text-right",attrs:{span:"4"}},[s("router-link",{staticClass:"icon icon-location",attrs:{tag:"div",to:t.util.getUrl({path:"/pages/order/location",query:{id:t.order.deliveryer.id}})}})],1)],1)]:t._e(),t._v(" "),s("div",{staticClass:"tip"},[t._v("货品信息")]),t._v(" "),s("van-cell-group",{staticClass:"goods-info"},[s("van-cell",{staticClass:"border-0px"},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("配送时间："+t._s(t.order.delivery_day)+" "+t._s(t.order.delivery_time))]),t._v(" "),s("div",{attrs:{slot:"right-icon"},slot:"right-icon"},[t._v("#"+t._s(t.order.serial_sn))])]),t._v(" "),s("div",{staticClass:"note"},[s("div",{staticClass:"left"},[t._v("备注:")]),t._v(" "),s("div",{staticClass:"right"},[t._v(t._s(t.order.note?t.order.note:"无"))])]),t._v(" "),s("div",{staticClass:"goods-list padding-15-b font-14 van-hairline--bottom"},t._l(t.order.goods,function(e,i){return s("div",{key:i,staticClass:"goods-item margin-15-lr margin-15-t flex-lr"},[s("div",{staticClass:"goods-title ellipsis"},[t._v(t._s(e.goods_title))]),t._v(" "),s("div",{staticClass:"goods-num"},[t._v("x"+t._s(e.goods_num))]),t._v(" "),s("div",{staticClass:"goods-price"},[t._v("¥"+t._s(e.goods_price))])])})),t._v(" "),s("div",{staticClass:"other padding-15-b font-14 c-gray"},[s("div",{staticClass:"other-item margin-15-lr margin-15-t flex-lr"},[s("div",[t._v("配送费")]),t._v(" "),s("div",[t._v("¥"+t._s(t.order.delivery_fee))])]),t._v(" "),s("div",{staticClass:"other-item margin-15-lr margin-15-t flex-lr"},[s("div",[t._v("餐盒费")]),t._v(" "),s("div",[t._v("¥"+t._s(t.order.box_price))])]),t._v(" "),s("div",{staticClass:"other-item margin-15-lr margin-15-t flex-lr"},[s("div",[t._v("包装费")]),t._v(" "),s("div",[t._v("¥"+t._s(t.order.pack_fee))])]),t._v(" "),s("div",{staticClass:"other-item margin-15-lr margin-15-t flex-lr"},[s("div",[t._v("合计")]),t._v(" "),s("div",[t._v("¥"+t._s(t.order.total_fee))])]),t._v(" "),s("div",{staticClass:"other-item margin-15-lr margin-15-t flex-lr"},[s("div",[t._v("优惠")]),t._v(" "),s("div",[t._v("¥"+t._s(t.order.discount_fee))])]),t._v(" "),s("div",{staticClass:"other-item margin-15-lr margin-15-t flex-lr"},[s("div",[t._v("顾客实付")]),t._v(" "),s("div",[t._v("¥"+t._s(t.order.final_fee))])])])],1),t._v(" "),s("div",{staticClass:"tip"},[t._v("本单收支")]),t._v(" "),s("van-cell-group",{staticClass:"goods-info"},[s("van-cell",{attrs:{title:"本单平台共补贴",value:"￥"+t.order.plateform_discount_fee}}),t._v(" "),s("van-cell",{attrs:{title:"本单代理商共补贴",value:"￥"+t.order.agent_discount_fee}}),t._v(" "),s("van-cell",{attrs:{title:"商户实际入账",value:"￥"+t.order.store_final_fee}}),t._v(" "),s("van-cell",{attrs:{title:"代理商抽取佣金",value:"￥"+t.order.plateform_serve_fee}}),t._v(" "),t.order.agentid>0?[s("van-cell",{attrs:{title:"平台服务佣金(平台收取代理商)",value:"￥"+t.order.agent_serve_fee}}),t._v(" "),s("van-cell",{attrs:{title:"代理商实际收入",value:"￥"+t.order.agent_final_fee}})]:t._e()],2),t._v(" "),s("div",{staticClass:"tip"},[t._v("订单信息")]),t._v(" "),s("van-cell-group",{staticClass:"order-info"},[s("van-cell",[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"padding-15-r"},[t._v("订单编号")]),t._v("\n\t\t\t\t\t"+t._s(t.order.ordersn)+"\n\t\t\t\t")])]),t._v(" "),s("van-cell",[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"padding-15-r"},[t._v("下单时间")]),t._v("\n\t\t\t\t\t"+t._s(t.order.addtime_cn)+"\n\t\t\t\t")])]),t._v(" "),s("van-cell",[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"padding-15-r"},[t._v("支付方式")]),t._v("\n\t\t\t\t\t"+t._s(t.order.pay_type_cn)+"\n\t\t\t\t")])])],1),t._v(" "),s("div",{staticClass:"times van-hairline--bottom bg-default margin-10-t padding-15-lr padding-10-tb flex-lr font-14 text-center"},[t.order.delivery_assign_time_cn?s("div",{staticClass:"time-item"},[s("div",{staticClass:"time-title margin-10-b"},[t._v("接单")]),t._v(" "),s("div",{staticClass:"day"},[t._v(t._s(t.order.delivery_assign_time_cn.day))]),t._v(" "),s("div",{staticClass:"time"},[t._v(t._s(t.order.delivery_assign_time_cn.time))])]):t._e(),t._v(" "),t.order.delivery_instore_time_cn?s("div",{staticClass:"time-item"},[s("div",{staticClass:"time-title margin-10-b"},[t._v("到店")]),t._v(" "),s("div",{staticClass:"day"},[t._v(t._s(t.order.delivery_instore_time_cn.day))]),t._v(" "),s("div",{staticClass:"time"},[t._v(t._s(t.order.delivery_instore_time_cn.time))])]):t._e(),t._v(" "),t.order.delivery_takegoods_time_cn?s("div",{staticClass:"time-item"},[s("div",{staticClass:"time-title margin-10-b"},[t._v("取货")]),t._v(" "),s("div",{staticClass:"day"},[t._v(t._s(t.order.delivery_takegoods_time_cn.day))]),t._v(" "),s("div",{staticClass:"time"},[t._v(t._s(t.order.delivery_takegoods_time_cn.time))])]):t._e(),t._v(" "),t.order.delivery_success_time_cn?s("div",{staticClass:"time-item"},[s("div",{staticClass:"time-title margin-10-b"},[t._v("送达")]),t._v(" "),s("div",{staticClass:"day"},[t._v(t._s(t.order.delivery_success_time_cn.day))]),t._v(" "),s("div",{staticClass:"time"},[t._v(t._s(t.order.delivery_success_time_cn.time))])]):t._e()]),t._v(" "),s("van-row",{staticClass:"btn-group bg-default"},[t.order.status<5?[1==t.order.is_pay&&"delivery"!=t.order.pay_type?s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"cancel_refund")}}},[t._v("取消订单并退款")])]):s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"cancel")}}},[t._v("取消订单")])]),t._v(" "),1==t.order.status?[s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-primary",on:{click:function(e){t.onChangeOrderStatus(t.order,"handle")}}},[t._v("确定接单")])]),t._v(" "),s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-primary",on:{click:function(e){t.onChangeOrderStatus(t.order,"notify_clerk_handle")}}},[t._v("通知商户")])])]:t._e(),t._v(" "),1==t.order.order_type?[2==t.order.status||3==t.order.status?[s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-primary",on:{click:function(e){t.onChangeOrderStatus(t.order,"notify_deliveryer_collect")}}},[t._v("通知配送员抢单")])]),t._v(" "),2==t.order.delivery_type?s("van-col",{attrs:{span:"8"}},[s("router-link",{staticClass:"btn-item bg-primary",attrs:{tag:"div",to:t.util.getUrl({path:"pages/order/dispatch",query:{id:t.order.id}})}},[t._v("调度")])],1):t._e(),t._v(" "),t.order.uupaotui_status&&2==t.order.delivery_type?s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-primary",on:{click:function(e){t.onPushUUPaotui()}}},[t._v("UU配送")])]):t._e()]:t._e(),t._v(" "),4==t.order.status?[s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-primary",on:{click:function(e){t.onChangeOrderStatus(t.order,"re_notify_deliveryer_collect")}}},[t._v("重新待抢订单")])]),t._v(" "),s("van-col",{attrs:{span:"8"}},[s("router-link",{staticClass:"btn-item bg-primary",attrs:{tag:"div",to:t.util.getUrl({path:"pages/order/dispatch",query:{id:t.order.id}})}},[t._v("重新调度")])],1)]:t._e(),t._v(" "),t.order.status>1?[s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-primary",on:{click:function(e){t.onChangeOrderStatus(t.order,"end")}}},[t._v("完成订单")])])]:t._e()]:[s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-primary",on:{click:function(e){t.onChangeOrderStatus(t.order,"end")}}},[t._v("完成订单")])])]]:t._e(),t._v(" "),1==t.order.refund_status?[s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"refund_handle")}}},[t._v("发起退款")])]),t._v(" "),s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"refund_status")}}},[t._v("已退款")])])]:2==t.order.refund_status?[s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-primary",on:{click:function(e){t.onChangeOrderStatus(t.order,"refund_query")}}},[t._v("查询退款进度")])]),t._v(" "),s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"btn-item bg-danger",on:{click:function(e){t.onChangeOrderStatus(t.order,"refund_status")}}},[t._v("已退款")])])]:t._e()],2)],2):t._e(),t._v(" "),t.showPreLoading?s("iloading"):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left"},[e("div",{staticClass:"circle"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left"},[e("div",{staticClass:"circle"})])}]};var l=s("VU/8")(a,d,!1,function(t){s("sSx1")},null,null);e.default=l.exports},sSx1:function(t,e){}});