webpackJsonp([11],{fQCU:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),s=a.n(i),o=a("Gu7T"),r=a.n(o),n=a("Cz8s"),l=a("+CBI"),c=a("deIj"),d=a("+TmT"),u={data:function(){return{id:0,thumb:{},thumbs:[],goodsCategory:!1,category:[],datePicker:{type:"",maxDate:new Date(2050,12),currentDate:new Date,status:!1},bestsetting:"0",showPreLoading:!0,records:{name:"",cateid:"",category_title:"",status:"2",starttime_cn:"",endtime_cn:"",code:"",detail:"",rules:[],thumb:[],thumbs:[],helplimit:"0",dayhelplimit:"0",joinlimit:"0",falsejoinnum:"0",falselooknum:"0",falsesharenum:"0"}}},components:{publicHeader:n.a,iswitch:l.a,Uploader:d.a},methods:{onLoad:function(){var t=this;Object(c.a)({vue:t,url:"manage/kanjia/goods/post",data:{id:t.id},success:function(e){if(t.records=t.util.extend(t.records,e.records),e.category&&(t.category=[].concat(r()(t.category),r()(e.category))),t.records.thumbs&&t.records.thumbs.length>0)for(var a in t.records.thumbs)t.thumbs.push({url:t.records.thumbs[a]})}})},onChangeThumbs:function(t){var e=[];if(t&&t.length>0)for(var a in t)e.push(t[a].url);this.records.thumbs=e},onTogglePopup:function(){this.goodsCategory=!this.goodsCategory},onToggleDatePicker:function(t){this.datePicker.status=!this.datePicker.status,t&&(this.datePicker.type=t)},onConfirmTime:function(t){var e=this.util.formatDate(t);"start"==this.datePicker.type?this.records.starttime_cn=e:this.records.endtime_cn=e,this.onToggleDatePicker()},onConfirmCategory:function(t){this.records.cateid=t.id,this.records.category_title=t.title,this.onTogglePopup()},onAaddRule:function(){this.records.rules.push({range:"0",range_start:0,range_end:0})},onDelRule:function(t){this.records.rules.splice(t,1)},jsToggleSwitch:function(t){this.util.jsToggleSwitch({vue:this,key:t.keys,value:t.value})},onUploadImage:function(t){var e=this;e.util.image({obj:t,success:function(t,a){a.url&&a.filename&&(e.thumb={url:a.url,filename:a.filename},e.thumb=s()({},e.thumb),e.records.thumb=e.thumb.url)},options:{channel:"h5"}})},onSubmit:function(){return this.records.name?this.records.oldprice?this.records.price?void Object(c.c)({vue:this,url:"manage/kanjia/goods/post",data:{id:this.id,data:this.records},redirect:this.util.getUrl({path:"/pages/gohome/kanjia/goods/list"})}):(this.util.$toast("商品现价不能为空","",1e3),!1):(this.util.$toast("商品原价不能为空","",1e3),!1):(this.util.$toast("名称不能为空","",1e3),!1)}},created:function(){this.$route.query&&this.$route.query.id>0&&(this.id=parseInt(this.$route.query.id))},mounted:function(){this.onLoad()}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"kanjiagoods-post"}},[a("public-header",{attrs:{title:"添加砍价商品"}}),t._v(" "),a("div",{staticClass:"content"},[a("van-cell-group",[a("van-cell",{staticClass:"no-fix flex "},[a("div",{staticClass:"padding-10-b flex-lr"},[a("div",[t._v("商品图片")]),t._v(" "),a("div",{staticClass:"c-gray"},[t._v("此图片为商品列表页图片")])]),t._v(" "),a("div",{staticClass:"goods-thumb-wrap"},[t.records.thumb.length>0?a("img",{staticClass:"goods-thumb ",attrs:{src:t.records.thumb,alt:""}}):a("img",{staticClass:"goods-thumb ",attrs:{src:"static/img/add_pic.png",alt:""}}),t._v(" "),a("input",{staticClass:"weui-uploader__input",attrs:{type:"file",multiple:"multiple",accept:"image/*"},on:{change:function(e){t.onUploadImage(e)}}})])]),t._v(" "),a("van-cell",[a("div",{staticClass:"upload-img"},[a("div",{staticClass:"flex-lr goods-img"},[a("div",[t._v("商品图集")]),t._v(" "),a("div",{staticClass:"c-gray"},[t._v("最多显示4张，此图片为商品图集")])]),t._v(" "),a("uploader",{attrs:{max:4,value:t.thumbs},on:{onGetUrl:t.onChangeThumbs,delete:t.onChangeThumbs}})],1)]),t._v(" "),a("van-field",{attrs:{label:"商品编码",placeholder:"请填写商品编码","input-align":"right"},model:{value:t.records.code,callback:function(e){t.$set(t.records,"code",e)},expression:"records.code"}}),t._v(" "),a("van-field",{attrs:{label:"商品名称",placeholder:"请填写商品名称","input-align":"right"},model:{value:t.records.name,callback:function(e){t.$set(t.records,"name",e)},expression:"records.name"}}),t._v(" "),a("van-field",{attrs:{label:"商品库存",placeholder:"请填写商品库存","input-align":"right"},model:{value:t.records.total,callback:function(e){t.$set(t.records,"total",e)},expression:"records.total"}}),t._v(" "),a("van-field",{attrs:{label:"商品单位",placeholder:"请填写商品单位","input-align":"right"},model:{value:t.records.unit,callback:function(e){t.$set(t.records,"unit",e)},expression:"records.unit"}}),t._v(" "),a("van-field",{attrs:{label:"商品详情",type:"textarea",placeholder:"请填写商品详情",rows:"1","input-align":"right",autosize:""},model:{value:t.records.detail,callback:function(e){t.$set(t.records,"detail",e)},expression:"records.detail"}})],1),t._v(" "),a("van-cell-group",{staticClass:"margin-10-t"},[a("van-cell",{attrs:{title:"商品分类"}},[a("div",{staticClass:"flex",attrs:{slot:"right-icon"},on:{click:t.onTogglePopup},slot:"right-icon"},[a("span",[t._v(t._s(t.records.category_title?t.records.category_title:"请选择"))]),t._v(" "),a("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),a("van-field",{attrs:{label:"商品原价",type:"number",placeholder:"请输入商品原价","input-align":"right"},model:{value:t.records.oldprice,callback:function(e){t.$set(t.records,"oldprice",e)},expression:"records.oldprice"}}),t._v(" "),a("van-field",{attrs:{label:"活动底价",type:"number",placeholder:"请输入活动底价","input-align":"right"},model:{value:t.records.price,callback:function(e){t.$set(t.records,"price",e)},expression:"records.price"}}),t._v(" "),a("van-field",{attrs:{label:"允许提交订单金额限制",type:"number",placeholder:"请输入活动底价","input-align":"right"},model:{value:t.records.submitmoneylimit,callback:function(e){t.$set(t.records,"submitmoneylimit",e)},expression:"records.submitmoneylimit"}}),t._v(" "),a("van-cell",{attrs:{title:"活动开始时间"}},[a("div",{staticClass:"flex",attrs:{slot:"right-icon"},on:{click:function(e){t.onToggleDatePicker("start")}},slot:"right-icon"},[a("span",[t._v(t._s(this.records.starttime_cn?this.records.starttime_cn:"点击选择"))]),t._v(" "),a("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),a("van-cell",{attrs:{title:"活动结束时间"}},[a("div",{staticClass:"flex",attrs:{slot:"right-icon"},on:{click:function(e){t.onToggleDatePicker("end")}},slot:"right-icon"},[a("span",[t._v(t._s(this.records.endtime_cn?this.records.endtime_cn:"点击选择"))]),t._v(" "),a("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),a("van-cell",[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("活动状态")]),t._v(" "),a("iswitch",{attrs:{slot:"right-icon",value:t.records.status,"condition-open":"1","condition-close":"0","text-open":"ON","text-close":"OFF",keys:"records.status"},on:{change:t.jsToggleSwitch},slot:"right-icon"})],1)],1),t._v(" "),a("van-cell-group",{staticClass:"margin-10-t"},[a("van-cell",{attrs:{title:"砍价规则"}}),t._v(" "),t._l(t.records.rules,function(e,i){return a("div",{key:e.id,staticClass:"activity-box"},[a("div",{staticClass:"activity-col flex"},[a("div",[t._v("当前价格大于")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.range,expression:"item.range"}],staticClass:"input-rule",attrs:{type:"text"},domProps:{value:e.range},on:{input:function(a){a.target.composing||t.$set(e,"range",a.target.value)}}}),t._v(" "),a("div",[t._v("砍价范围")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.range_start,expression:"item.range_start"}],staticClass:"input-rule",attrs:{type:"text"},domProps:{value:e.range_start},on:{input:function(a){a.target.composing||t.$set(e,"range_start",a.target.value)}}}),t._v(" "),a("div",[t._v("到")]),t._v(" "),a("div",{staticClass:"input-unit",attrs:{slot:"right-icon"},slot:"right-icon"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.range_end,expression:"item.range_end"}],attrs:{type:"text"},domProps:{value:e.range_end},on:{input:function(a){a.target.composing||t.$set(e,"range_end",a.target.value)}}}),t._v(" "),a("span",[t._v("元")])]),t._v(" "),a("div",{staticClass:"icon icon-close",on:{click:function(e){t.onDelRule(i)}}})])])})],2),t._v(" "),a("div",{staticClass:"delete-rule",on:{click:t.onAaddRule}},[t._v("添加砍价规则")]),t._v(" "),t._e(),t._v(" "),a("van-cell-group",{staticClass:"margin-10-t"},[a("van-cell",[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("高级设置")]),t._v(" "),a("iswitch",{attrs:{slot:"right-icon",value:t.bestsetting,"condition-open":"1","condition-close":"0","text-open":"ON","text-close":"OFF",keys:"bestsetting"},on:{change:t.jsToggleSwitch},slot:"right-icon"})],1)],1),t._v(" "),"1"==t.bestsetting?[a("van-cell-group",{staticClass:"margin-10-t"},[a("van-field",{attrs:{label:"好友帮砍限制数量",placeholder:"填0或不填则无限制","input-align":"right"},model:{value:t.records.helplimit,callback:function(e){t.$set(t.records,"helplimit",e)},expression:"records.helplimit"}}),t._v(" "),a("van-field",{attrs:{label:"每天帮砍好友人数限制",placeholder:"填0或不填则无限制","input-align":"right"},model:{value:t.records.dayhelplimit,callback:function(e){t.$set(t.records,"dayhelplimit",e)},expression:"records.dayhelplimit"}}),t._v(" "),a("van-field",{attrs:{label:"参加人数限制",placeholder:"填0或不填则无限制","input-align":"right"},model:{value:t.records.joinlimit,callback:function(e){t.$set(t.records,"joinlimit",e)},expression:"records.joinlimit"}})],1),t._v(" "),a("van-cell-group",{staticClass:"margin-10-t"},[a("van-field",{attrs:{label:"虚拟参与人数",placeholder:"请输入虚拟参与人数","input-align":"right"},model:{value:t.records.falsejoinnum,callback:function(e){t.$set(t.records,"falsejoinnum",e)},expression:"records.falsejoinnum"}}),t._v(" "),a("van-field",{attrs:{label:"虚拟浏览量",placeholder:"请输入虚拟浏览量","input-align":"right"},model:{value:t.records.falselooknum,callback:function(e){t.$set(t.records,"falselooknum",e)},expression:"records.falselooknum"}}),t._v(" "),a("van-field",{attrs:{label:"虚拟分享次数",placeholder:"请输入虚拟分享次数","input-align":"right"},model:{value:t.records.falsesharenum,callback:function(e){t.$set(t.records,"falsesharenum",e)},expression:"records.falsesharenum"}})],1)]:t._e(),t._v(" "),a("div",{staticClass:"padding-15"},[a("van-button",{staticClass:"bg-info",attrs:{size:"normal",block:""},on:{click:t.onSubmit}},[t._v("提交")])],1)],2),t._v(" "),t.showPreLoading?a("iloading"):t._e(),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.goodsCategory,callback:function(e){t.goodsCategory=e},expression:"goodsCategory"}},[a("van-picker",{attrs:{"show-toolbar":"",title:"所属分类",columns:t.category,"value-key":"title"},on:{cancel:t.onTogglePopup,confirm:t.onConfirmCategory}})],1),t._v(" "),a("van-popup",{staticClass:"popup-time",attrs:{position:"bottom"},model:{value:t.datePicker.status,callback:function(e){t.$set(t.datePicker,"status",e)},expression:"datePicker.status"}},[a("van-datetime-picker",{attrs:{type:"datetime","min-data":t.datePicker.currentDate,"max-date":t.datePicker.maxDate},on:{confirm:t.onConfirmTime,cancel:t.onToggleDatePicker},model:{value:t.datePicker.currentDate,callback:function(e){t.$set(t.datePicker,"currentDate",e)},expression:"datePicker.currentDate"}})],1)],1)},staticRenderFns:[]};var g=a("VU/8")(u,v,!1,function(t){a("n4Qs")},null,null);e.default=g.exports},n4Qs:function(t,e){}});
//# sourceMappingURL=11.a1f3f1bfe36169121326.js.map