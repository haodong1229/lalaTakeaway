{"version":3,"sources":["webpack:///src/pages/order/map.vue","webpack:///./src/pages/order/map.vue?f55c","webpack:///./src/pages/order/map.vue"],"names":["map","name","data","id","Number","markers","center","lat","lng","order","deliveryer_marker","AMap","Object","methods","onLoad","_this","this","util","request","url","then","res","result","message","errno","$toast","status","concat","toConsumableArray_default","latitude","longitude","loadmap","that","marker","Map","resizeEnable","zoom","Marker","position","offset","Pixel","content","setMap","vue_icon","delivery_success_location_y","delivery_success_location_x","params","deliveryer","avatar","push","setFitView","onRefresh","deliveryer_id","location_y","location_x","remove","onQuestion","$dialog","confirm","showCancelButton","created","$route","query","mounted","_this2","setInterval","order_map","render","_h","$createElement","_c","_self","attrs","_v","staticClass","tag","to","getUrl","path","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/107.7f0c64c52fc2f799d497.js","sourcesContent":["<template>\r\n\t<div id=\"order-map\">\r\n\t\t<div id=\"map-container\"></div>\r\n\t\t<router-link tag=\"div\" :to=\"util.getUrl({path: '/pages/order/detail', query: {id: id}})\" class=\"icons back-icon\">\r\n\t\t\t<div class=\"icon icon-arrow-left\"></div>\r\n\t\t</router-link>\r\n\t\t<div class=\"icons refresh-icon\" @click=\"onRefresh\">\r\n\t\t\t<div class=\"icon icon-refresh\"></div>\r\n\t\t</div>\r\n\t\t<div class=\"icons question-icon\" @click=\"onQuestion\">\r\n\t\t\t<div class=\"icon icon-question font-20\"></div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {Amap} from '@/config/AMap'\r\n\texport default {\r\n\t\tname: \"orderMap\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid: Number,\r\n\t\t\t\tmarkers: [],\r\n\t\t\t\tcenter: {\r\n\t\t\t\t\tlat: '',\r\n\t\t\t\t\tlng: '',\r\n\t\t\t\t},\r\n\t\t\t\torder: {},\r\n\t\t\t\tdeliveryer_marker: [],\r\n\t\t\t\tAMap: Amap()\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonLoad() {\r\n\t\t\t\tthis.util.request({\r\n\t\t\t\t\turl: 'wmall/order/index/location',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tid: this.id\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tvar result = res.data.message;\r\n\t\t\t\t\tif(result.errno) {\r\n\t\t\t\t\t\tthis.util.$toast(result.message);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.order = result.message.order;\r\n\t\t\t\t\tif(this.order.status == 5) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.markers = [...this.markers, ...result.message.markers];\r\n\t\t\t\t\tthis.center.lat = result.message.markers[0].latitude;\r\n\t\t\t\t\tthis.center.lng = result.message.markers[0].longitude;\r\n\t\t\t\t\tthis.loadmap();\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tloadmap(){\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthat.AMap.then(function(AMap){\r\n\t\t\t\t\tthat.map = new AMap.Map('map-container', {\r\n\t\t\t\t\t\tresizeEnable: true,\r\n\t\t\t\t\t\tcenter: [that.center.lng, that.center.lat],\r\n\t\t\t\t\t\tzoom: 10\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// 顾客位置\r\n\t\t\t\t\tif(that.markers[0].longitude && that.markers[0].latitude) {\r\n\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\tposition: [that.markers[0].longitude, that.markers[0].latitude],\r\n\t\t\t\t\t\t\toffset: new AMap.Pixel(-26, -80),\r\n\t\t\t\t\t\t\tcontent: '<div class=\"marker-mine-route\"></div>'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 商家位置\r\n\t\t\t\t\tif(that.markers[2].longitude && that.markers[2].latitude) {\r\n\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\tposition: [that.markers[2].longitude, that.markers[2].latitude],\r\n\t\t\t\t\t\t\toffset: new AMap.Pixel(-33, -70),\r\n\t\t\t\t\t\t\tcontent: '<div class=\"marker-start-head-route\"><img src=\"' + that.markers[2].vue_icon + '\" alt=\"\"/></div>'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 配送员位置\r\n\t\t\t\t\tif(that.order.status == 5) {\r\n\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\tposition: [that.order.delivery_success_location_y, that.order.delivery_success_location_x],\r\n\t\t\t\t\t\t\toffset: new AMap.Pixel(-26, -80),\r\n\t\t\t\t\t\t\tcontent: '<div class=\"marker-deliveyer-route\"><img src='+ params.deliveryer.avatar +' alt=\"\"/></div>'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif(that.markers[1].longitude && that.markers[1].latitude) {\r\n\t\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\t\tposition: [that.markers[1].longitude, that.markers[1].latitude],\r\n\t\t\t\t\t\t\t\toffset: new AMap.Pixel(-26, -80),\r\n\t\t\t\t\t\t\t\tcontent: '<div class=\"marker-deliveyer-route\"><img src=\"' + that.markers[1].vue_icon + '\" alt=\"\"/></div>'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t\t\tthat.deliveryer_marker.push(marker);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.map.setFitView();\r\n\t\t\t\t});\r\n\r\n\t\t\t},\r\n\t\t\tonRefresh() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(that.order.status == 5){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tthat.util.request({\r\n\t\t\t\t\turl: 'system/common/deliveryer/location',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tid: that.order.deliveryer_id\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tvar result = res.data.message;\r\n\t\t\t\t\tif(result.errno) {\r\n\t\t\t\t\t\tthat.util.$toast(result.message);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar deliveryer = result.message;\r\n\t\t\t\t\tthat.AMap.then(function(AMap){\r\n\t\t\t\t\t\tvar marker = new AMap.Marker({\r\n\t\t\t\t\t\t\tposition: [deliveryer.location_y, deliveryer.location_x],\r\n\t\t\t\t\t\t\toffset: new AMap.Pixel(-26, -80),\r\n\t\t\t\t\t\t\tcontent: '<div class=\"marker-deliveyer-route\"><img src=\"'+ deliveryer.avatar +'\" alt=\"\"/></div>'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthat.map.remove(that.deliveryer_marker);\r\n\t\t\t\t\t\tmarker.setMap(that.map);\r\n\t\t\t\t\t\tthat.deliveryer_marker.push(marker);\r\n\t\t\t\t\t\tthat.map.setFitView();\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tonQuestion() {\r\n\t\t\t\tthis.$dialog.confirm({\r\n\t\t\t\t\tmessage: '要获取最新位置，请点击刷新按钮；如果配送员远离您，那可能是正在为更早下单的用户配送，请耐心等待~',\r\n\t\t\t\t\tshowCancelButton: false\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tif(this.$route.query.id) {\r\n\t\t\t\tthis.id = this.$route.query.id\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.onLoad();\r\n\t\t\tsetInterval(() => {\r\n\t\t\t\tthis.onRefresh();\r\n\t\t\t}, 30000)\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t#order-map{\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tleft: 0;\r\n\t}\r\n\t#order-map #map-container{\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\t#order-map .icons{\r\n\t\tposition: absolute;\r\n\t\tz-index: 100;\r\n\t\theight: 36px;\r\n\t\twidth: 36px;\r\n\t\ttext-align: center;\r\n\t\tline-height: 36px;\r\n\t\tborder-radius: 100%;\r\n\t\tbackground: #9b9a96;\r\n\t\topacity: 0.8;\r\n\t\tcolor: #FFF;\r\n\t}\r\n\t#order-map .back-icon{\r\n\t\ttop: 15px;\r\n\t\tleft: 15px;\r\n\t}\r\n\t#order-map .refresh-icon{\r\n\t\ttop: 15px;\r\n\t\tright: 15px;\r\n\t}\r\n\t#order-map .question-icon{\r\n\t\tbottom: 15px;\r\n\t\tright: 15px;\r\n\t}\r\n\t#order-map .amap-marker .marker-deliveyer-route{\r\n\t\tposition: relative; \r\n\t\twidth: 52px; \r\n\t\theight: 80px; \r\n\t\tcolor: #e90000; \r\n\t\tbackground: url(../../../static/img/map-location.png) no-repeat 0 0;\r\n\t\tcursor: pointer;\r\n\t}\r\n\t#order-map .amap-marker .marker-deliveyer-route img{\r\n\t\tposition:absolute; \r\n\t\ttop: 5px; \r\n\t\tright: 5px; \r\n\t\twidth: 42px; \r\n\t\theight: 42px; \r\n\t\tborder-radius: 100%;\r\n\t}\r\n\t#order-map .amap-marker .marker-start-head-route {\r\n\t\tposition: relative;\r\n\t\twidth: 70px;\r\n\t\theight: 70px;\r\n\t\tcolor: #e90000;\r\n\t\tbackground: url(../../../static/img/map-start-head.png) no-repeat 0 0;\r\n\t\tbackground-size: cover;\r\n\t\tcursor: pointer;\r\n\t}\r\n\t#order-map .amap-marker .marker-start-head-route img {\r\n\t\tposition: absolute;\r\n\t\ttop: 12px;\r\n\t\tright: 12px;\r\n\t\twidth: 46px;\r\n\t\theight: 46px;\r\n\t\tborder-radius: 100%\r\n\t}\r\n\t#order-map .amap-marker .marker-mine-route {\r\n\t\tposition: relative;\r\n\t\twidth: 70px;\r\n\t\theight: 70px;\r\n\t\tcolor: #e90000;\r\n\t\tbackground: url(../../../static/img/map-lbs.png) no-repeat 0 0;\r\n\t\tbackground-size: cover;\r\n\t\tcursor: pointer;\r\n\t}\r\n\t.amap-marker .marker-mine-route img {\r\n\t\tposition: absolute;\r\n\t\ttop: 12px;\r\n\t\tright: 12px;\r\n\t\twidth: 46px;\r\n\t\theight: 46px;\r\n\t\tborder-radius: 100%\r\n\t}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/pages/order/map.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"order-map\"}},[_c('div',{attrs:{\"id\":\"map-container\"}}),_vm._v(\" \"),_c('router-link',{staticClass:\"icons back-icon\",attrs:{\"tag\":\"div\",\"to\":_vm.util.getUrl({path: '/pages/order/detail', query: {id: _vm.id}})}},[_c('div',{staticClass:\"icon icon-arrow-left\"})]),_vm._v(\" \"),_c('div',{staticClass:\"icons refresh-icon\",on:{\"click\":_vm.onRefresh}},[_c('div',{staticClass:\"icon icon-refresh\"})]),_vm._v(\" \"),_c('div',{staticClass:\"icons question-icon\",on:{\"click\":_vm.onQuestion}},[_c('div',{staticClass:\"icon icon-question font-20\"})])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-434272fb\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/order/map.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-434272fb\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./map.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./map.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./map.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-434272fb\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./map.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/order/map.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}