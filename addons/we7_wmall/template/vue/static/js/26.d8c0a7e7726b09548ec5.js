webpackJsonp([26],{UC7n:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=s("Cz8s"),n=s("Fd2+"),e=s("deIj"),d={components:{PublicHeader:a.a,Dialog:n.a},data:function(){return{showPreLoading:!0,pindan:{mine:{}},store:{},extra:{}}},computed:{cartSendCondition:function(){return(this.store.send_price-this.pindan.total_cart_price).toFixed(2)}},methods:{onLoad:function(){var t=this;Object(e.a)({vue:t,url:"wmall/store/goods/pindan",data:{sid:t.sid,pindan_id:t.pindan_id},success:function(i){t.pindan=i.pindan,t.store=i.store,t.extra=i.extra;var s=window._share;s&&(s.success=function(){t.util.request({}).then(function(t){})}),t.wx.share(s)}})},onGiveUp:function(t){var i=this,s="确定不要继续拼单了吗？";1==i.extra.is_founder&&(s="删除后不可恢复，确认删除吗？"),Object(e.c)({vue:i,confirm:s,url:"wmall/store/goods/giveupPindan",data:{sid:i.sid,cart_id:t},success:function(t){i.pindan=t.pindan,i.extra.not_takepart=1},fail:function(t){-1e3==t.errno&&i.util.$toast("取消拼单成功",i.util.getUrl({path:"pages/store/goods",query:{sid:i.store.id}}),1e3)}})},onContinue:function(t){var i=this;Object(e.c)({vue:i,url:"wmall/store/goods/continuePindan",data:{sid:i.sid},success:function(t){i.onLoad()}})},onTakePindan:function(){this.$router.push(this.util.getUrl({path:"/pages/store/goods",query:{sid:this.store.id,pindan_id:this.pindan.pindan_id}}))},onSubmit:function(){var t=this;n.a.confirm({title:"温馨提示",message:"去结算后其他用户不可加入，确定去结算吗？"}).then(function(){t.$router.push(t.util.getUrl({path:"/pages/order/create",query:{sid:t.store.id,is_pindan:1,pindan_id:t.pindan.pindan_id}}))})}},created:function(){this.$route.query&&this.$route.query.sid>0&&(this.sid=this.$route.query.sid,this.pindan_id=0,this.$route.query.pindan_id>0&&(this.pindan_id=this.$route.query.pindan_id))},mounted:function(){this.onLoad()}},r={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{attrs:{id:"store-pindan"}},[s("public-header",{attrs:{title:"拼单"}}),t._v(" "),s("div",{staticClass:"content"},[1==t.extra.is_founder&&2==t.pindan.mine.pindan_status?s("tempalte",[s("div",{staticClass:"lock"},[s("div",{staticClass:"lock-inner w-100 text-center"},[s("div",{staticClass:"tip font-15"},[t._v("锁定状态，手动解锁后可继续拼单")]),t._v(" "),s("van-button",{staticClass:"bg-danger font-16 deblock",attrs:{size:"normal",block:""},on:{click:t.onContinue}},[t._v("解锁")])],1)])]):[s("div",{staticClass:"content-inner"},[s("div",{staticClass:"store bg-default span-center padding-15"},[s("img",{attrs:{src:t.store.logo}}),t._v(" "),s("div",{staticClass:"name ellipsis"},[t._v(t._s(t.store.title))]),t._v(" "),1==t.extra.is_founder?s("van-button",{staticClass:"bg-danger font-16",attrs:{size:"normal",block:""}},[t._v("邀请好友")]):t._e(),t._v(" "),1==t.extra.not_takepart?s("van-button",{staticClass:"bg-danger font-16",attrs:{size:"normal",block:""},on:{click:t.onTakePindan}},[t._v("参与拼单")]):t._e()],1),t._v(" "),s("div",{staticClass:"font-14 c-gray margin-10"},[t._v("拼单列表")]),t._v(" "),t.pindan.mine?s("div",{staticClass:"order-info bg-default padding-10-l"},[t.pindan.mine.member?s("div",{staticClass:"user flex-lr padding-10-t"},[s("div",{staticClass:"left flex"},[s("img",{staticClass:"avatar",attrs:{src:t.pindan.mine.member.avatar}})]),t._v(" "),s("div",{staticClass:"right flex-lr van-hairline--bottom"},[s("div",{staticClass:"nickname"},[s("span",{staticClass:"ellipsis"},[t._v(t._s(t.pindan.mine.member.realname))]),t._v(" "),s("span",{staticClass:"label label-mine"},[t._v("我")]),t._v(" "),t.pindan.mine.id==t.pindan.pindan_id?s("span",{staticClass:"label label-start"},[t._v("发起")]):t._e()]),t._v(" "),s("div",{staticClass:"btn-group flex"},[s("router-link",{staticClass:"btn-item edit-btn",attrs:{to:t.util.getUrl({path:"pages/store/goods",query:{sid:t.store.id,pindan_id:t.pindan_id}})}},[t._v("编辑商品")]),t._v(" "),s("div",{staticClass:"btn-item cancle-btn",on:{click:function(i){t.onGiveUp(t.pindan.mine.id)}}},[t._v("不拼了")])],1)])]):t._e(),t._v(" "),t.pindan.mine.data?s("div",{staticClass:"goods flex-lr"},[s("div",{staticClass:"left"}),t._v(" "),s("div",{staticClass:"right"},[t._l(t.pindan.mine.data,function(i){return t._l(i,function(i){return s("div",{key:i.id,staticClass:"goods-item"},[s("div",{staticClass:"goods-title ellipsis"},[t._v(t._s(i.title))]),t._v(" "),s("div",{staticClass:"goods-num"},[t._v("x"+t._s(i.num))]),t._v(" "),s("div",{staticClass:"goods-price c-danger"},[t._v("¥"+t._s(i.total_discount_price))])])})}),t._v(" "),s("div",{staticClass:"goods-item"},[s("div",{staticClass:"goods-title ellipsis"},[t._v("餐盒费")]),t._v(" "),s("div",{staticClass:"goods-num"}),t._v(" "),s("div",{staticClass:"goods-price c-danger"},[t._v("¥"+t._s(t.pindan.mine.box_price))])])],2)]):t._e()]):t._e(),t._v(" "),t.pindan.other&&t.pindan.other.length>0?[s("div",{staticClass:"font-14 c-gray margin-10"},[t._v("其他拼友")]),t._v(" "),t._l(t.pindan.other,function(i){return s("div",{key:i.id,staticClass:"order-info bg-default padding-10-l margin-10-b"},[s("div",{staticClass:"user flex-lr padding-10-t"},[s("div",{staticClass:"left flex"},[s("img",{staticClass:"avatar",attrs:{src:i.member.avatar}})]),t._v(" "),s("div",{staticClass:"right flex-lr van-hairline--bottom"},[s("div",{staticClass:"nickname"},[s("span",{staticClass:"ellipsis"},[t._v(t._s(i.member.realname))]),t._v(" "),i.id==t.pindan.pindan_id?s("span",{staticClass:"label label-start"},[t._v("发起")]):t._e()]),t._v(" "),t.extra.is_founder?s("i",{staticClass:"icon icon-delete margin-10-r font-18 c-gray",on:{click:function(s){t.onGiveUp(i.id)}}}):t._e()])]),t._v(" "),s("div",{staticClass:"goods flex-lr"},[s("div",{staticClass:"left"}),t._v(" "),s("div",{staticClass:"right"},[t._l(i.data,function(i){return t._l(i,function(i){return s("div",{key:i.id,staticClass:"goods-item"},[s("div",{staticClass:"goods-title ellipsis"},[t._v(t._s(i.title))]),t._v(" "),s("div",{staticClass:"goods-num"},[t._v("x"+t._s(i.num))]),t._v(" "),s("div",{staticClass:"goods-price c-danger"},[t._v("¥"+t._s(i.total_discount_price))])])})}),t._v(" "),s("div",{staticClass:"goods-item"},[s("div",{staticClass:"goods-title ellipsis"},[t._v("餐盒费")]),t._v(" "),s("div",{staticClass:"goods-num"}),t._v(" "),s("div",{staticClass:"goods-price c-danger"},[t._v("¥"+t._s(i.box_price))])])],2)])])})]:t._e(),t._v(" "),s("van-cell-group",{staticClass:"margin-10-t"},[t.store.pack_fee>0?s("van-cell",{attrs:{title:"包装费"}},[s("span",{attrs:{slot:"right-icon"},slot:"right-icon"},[s("span",{staticClass:"c-danger"},[t._v("¥"+t._s(t.store.pack_fee))])])]):t._e(),t._v(" "),s("van-cell",{attrs:{title:"配送费"}},[s("span",{attrs:{slot:"right-icon"},slot:"right-icon"},[t._v("\n\t\t\t\t\t\t\t另需配送费 "),s("span",{staticClass:"c-danger"},[t._v("¥"+t._s(t.store.delivery_price))])])]),t._v(" "),s("van-cell",{attrs:{title:"总计"}},[s("span",{staticClass:"c-danger",attrs:{slot:"right-icon"},slot:"right-icon"},[t._v("\n\t\t\t\t\t\t\t¥"+t._s(t.pindan.total_cart_price)+"\n\t\t\t\t\t\t")])])],1)],2),t._v(" "),s("div",{staticClass:"cart flex-lr"},[s("div",{staticClass:"cart-tips"},[s("div",{staticClass:"total font-bold"},[t._v("¥"+t._s(t.pindan.total_cart_price))]),t._v(" "),s("div",{staticClass:"delivery-fee"},[t._v("另需配送费¥"+t._s(t.store.delivery_price))])]),t._v(" "),t.cartSendCondition>0?s("div",{staticClass:"cart-btn disabled"},[t._v("差¥"+t._s(t.cartSendCondition)+"起送")]):t._e(),t._v(" "),1==t.extra.is_founder&&t.cartSendCondition<=0?s("div",{staticClass:"cart-btn ",class:{disabled:0},on:{click:t.onSubmit}},[t._v("去结算")]):t._e()])]],2),t._v(" "),s("transition",{attrs:{name:"loading"}},[t.showPreLoading?s("iloading"):t._e()],1)],1)},staticRenderFns:[]};var o=s("VU/8")(d,r,!1,function(t){s("d/Ln")},null,null);i.default=o.exports},"d/Ln":function(t,i){}});