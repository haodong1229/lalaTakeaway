webpackJsonp([128],{dY9u:function(t,e){},pFum:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Cz8s"),o=i("GQaK"),s={data:function(){return{showPreLoading:!0,allcategory:[],scrollY:0,listHeight:[],tabActive:0,vanColHeight:0,getLocationStatus:!0,failedTips:{type:"location",tips:"获取定位失败!您可以选择手动搜索地址",btnText:"手动搜索地址",link:"/pages/home/location"}}},components:{PublicHeader:a.a},methods:{onLoad:function(){var t=this,e=this;e.util.request({url:"wmall/home/search/allcategory",data:{forceLocation:1}}).then(function(t){e.showPreLoading=!1;var i=t.data.message;i.errno?e.util.toast(i.message,"",1e3):(e.allcategory=i.message.allcategory,e.$nextTick(function(){e._initScroll(),e._calculateHeight()}))}).catch(function(e){"fail"==window.forceGetLocationStatus&&(t.showPreLoading=!1,t.getLocationStatus=!1)})},onGoCategory:function(t,e){this.$router.push(this.util.getUrl({path:"pages/home/category",query:{cid:t,child_id:e}}))},selectCategory:function(t,e){if(console.log(e._constructed),e._constructed){var i=this.$refs.childCategoryItem[t];this.rigthScroll.scrollToElement(i,500)}},_initScroll:function(){var t=this;this.leftScroll=new o.a(this.$refs.leftCategoryWrapper,{click:!0}),this.rigthScroll=new o.a(this.$refs.rightCategoryWrapper,{click:!0,probeType:3}),this.rigthScroll.on("scroll",function(e){e.y<=0&&(t.scrollY=Math.abs(Math.round(e.y)));for(var i=t.listHeight.length,a=0;a<i;a++){var o=t.listHeight[a],s=t.listHeight[a+1];s&&t.scrollY>=o&&t.scrollY<s&&a!=t.tabActive&&(t.tabActive=a,t._followScroll(a))}})},_calculateHeight:function(){var t=this.$refs.childCategoryItem,e=0;this.listHeight.push(0);for(var i=0;i<t.length;i++){e+=t[i].clientHeight,this.listHeight.push(e)}},_followScroll:function(t){var e=this.$refs.leftCategoryItem[t];this.leftScroll.scrollToElement(e,300,0,-100)}},mounted:function(){var t=this;this.onLoad(),this.$nextTick(function(){var e=document.documentElement.clientHeight;if(console.log(e),t.vanColHeight=e,document.getElementById("public-header")){var i=document.getElementById("public-header").clientHeight;t.vanColHeight=t.vanColHeight-i}})}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"home-allcategory"}},[i("public-header",{attrs:{title:"全部分类"}}),t._v(" "),i("div",{staticClass:"content"},[i("van-row",[i("van-col",{style:{height:t.vanColHeight+"px"},attrs:{span:"5"}},[i("div",{ref:"leftCategoryWrapper",staticClass:"tab-list",style:{height:t.vanColHeight+"px"}},[i("div",t._l(t.allcategory,function(e,a){return i("div",{key:a,ref:"leftCategoryItem",refInFor:!0,staticClass:"tab-item",class:{active:t.tabActive==a},on:{click:function(e){return t.selectCategory(a,e)}}},[i("div",{staticClass:"category-name"},[t._v(t._s(e.title))]),t._v(" "),i("span",{staticClass:"category-num"},[t._v(t._s(e.store_num))])])}),0)])]),t._v(" "),i("van-col",{style:{height:t.vanColHeight+"px"},attrs:{span:"19"}},[i("div",{ref:"rightCategoryWrapper",style:{height:t.vanColHeight+"px"}},[i("div",t._l(t.allcategory,function(e,a){return i("div",{key:a,ref:"childCategoryItem",refInFor:!0,staticClass:"category-item"},[i("div",{staticClass:"goods-title flex-lr"},[i("div",{staticClass:"font-15"},[t._v(t._s(e.title))]),t._v(" "),i("div",{staticClass:"font-13 c-gray",on:{click:function(i){return t.onGoCategory(e.id)}}},[t._v("去频道 "),i("span",{staticClass:"icon icon-right"})])]),t._v(" "),i("div",{staticClass:"goods-group"},[e.child?i("van-row",t._l(e.child,function(a,o){return i("van-col",{key:o,attrs:{span:"8"}},[i("div",{staticClass:"goods-item",on:{click:function(i){return t.onGoCategory(e.id,a.id)}}},[i("img",{attrs:{src:a.thumb,alt:""}}),t._v(" "),i("div",{staticClass:"font-14 padding-5-t"},[t._v(t._s(a.title))]),t._v(" "),i("span",{staticClass:"goods-num"},[t._v(t._s(a.store_num))])])])}),1):i("van-row",[i("van-col",{attrs:{span:"8"}},[i("div",{staticClass:"goods-item",on:{click:function(i){return t.onGoCategory(e.id)}}},[i("img",{attrs:{src:e.thumb,alt:""}}),t._v(" "),i("div",{staticClass:"font-14 padding-5-t"},[t._v(t._s(e.title))]),t._v(" "),i("span",{staticClass:"goods-num"},[t._v(t._s(e.store_num))])])])],1)],1)])}),0)])])],1)],1),t._v(" "),t.showPreLoading?i("iloading"):t._e(),t._v(" "),t.getLocationStatus?t._e():i("failed-tips",{attrs:{failedTips:t.failedTips}})],1)},staticRenderFns:[]};var n=i("VU/8")(s,l,!1,function(t){i("dY9u")},null,null);e.default=n.exports}});
//# sourceMappingURL=128.ff889744c7e2145af5db.js.map