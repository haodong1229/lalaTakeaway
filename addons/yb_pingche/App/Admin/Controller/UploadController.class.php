<?php
 namespace Admin\Controller; use Think\Controller; use Think\Upload; use Think\Upload\Driver\Oss; use Qiniu\Storage\UploadManager; use Qiniu\Auth; use Qiniu\Config; use Qiniu\Storage\BucketManager; use Ht\Controller\MemberController; class UploadController extends CommonController { public function uploadpic1() { goto PYdCf; Yc4I3: iHblK: goto W5JOE; B1AXB: $folder_tmp = "\x2e\57\120\165\x62\154\x69\143\57\125\160\x6c\x6f\141\144\163\x2f\x41\x64\x73\57"; goto VAKqx; Jz58h: jq7ML: goto XYGON; tDEdw: $data = array("\x63\157\x64\x65" => 1, "\x6d\163\147" => "\344\270\212\344\274\xa0\xe5\244\261\350\264\245"); goto fiob5; PYdCf: $this->getConfig(); goto q0n_5; W5JOE: $filename = explode("\56", strtolower($files["\156\x61\155\145"])); goto yY1nd; WInrv: $data = array("\x63\157\x64\x65" => 0, "\155\163\147" => "\344\270\212\344\xbc\240\346\x88\220\xe5\x8a\x9f", "\144\x61\x74\141" => $filename); goto anGET; dCkJj: $data = array("\143\157\144\145" => 1, "\x6d\163\147" => "\344\270\x8a\344\274\240\345\244\xb1\350\xb4\xa5"); goto dLTDS; Xie3_: exit(json_encode($data)); goto Jz58h; VAKqx: if (move_uploaded_file($tmpname, $folder_tmp . $filename)) { goto swczE; } goto dCkJj; anGET: BNV9O: goto xlyN3; L3Rss: if (in_array($files["\164\171\160\x65"], $arr)) { goto jq7ML; } goto Zhcau; kxbM5: exit(json_encode($data)); goto JwS_u; dLTDS: goto BNV9O; goto B9T_v; XYGON: $filename = date("\x59\155\x64\x48\151\163") . "\56" . $filename[count($filename) - 1]; goto BWJnE; Lx9zm: $files = $_FILES["\151\155\x67"]; goto jABJE; xlyN3: sUTV1: goto kxbM5; B9T_v: swczE: goto WInrv; BWJnE: $tmpname = $files["\164\x6d\160\x5f\156\141\155\x65"]; goto B1AXB; q0n_5: ini_set("\x64\141\x74\145\x2e\164\x69\x6d\145\172\x6f\x6e\x65", "\x41\163\x69\141\x2f\x43\150\x6f\x6e\147\161\151\156\x67"); goto Lx9zm; yY1nd: $arr = C("\165\x70\x74\x79\160\x65"); goto L3Rss; jABJE: if ($files) { goto iHblK; } goto tDEdw; Zhcau: $data = array("\x72\145\164\x43\157\144\145" => "\60\60\60\61", "\162\x65\x74\104\x65\163\x63" => "\351\235\236\346\263\x95\344\270\x8a\344\274\240"); goto Xie3_; fiob5: goto sUTV1; goto Yc4I3; JwS_u: } public function uploadpic() { goto iO8Zd; knZR_: if (!$_FILES["\151\x6d\x67"]) { goto ADaIg; } goto zryV2; zryV2: switch (C("\x75\x70\x6c\157\141\144\x5f\164\171\x70\x65")) { case 0: $Img = $this->saveimg_local($_FILES); goto IE6wo; case 1: $Img = $this->saveimg($_FILES); goto IE6wo; case 2: $Img = $this->qiniu_saveimg($_FILES); goto IE6wo; } goto Wpeqp; h60Dw: exit(json_encode($Img)); goto YW8r4; KrRq7: $Path = null; goto knZR_; Wpeqp: AAWOk: goto nC8JG; z0M7v: ADaIg: goto h60Dw; nC8JG: IE6wo: goto z0M7v; hUOLJ: $Img = I("\111\155\x67"); goto KrRq7; iO8Zd: $this->getConfig(); goto hUOLJ; YW8r4: } private function saveimg_local($files) { goto fNLTQ; aToD4: $info = $upload->upload($files); goto Sdll0; cvWfX: $data = $ImgStr; goto aJbnP; epGzF: return ["\x63\x6f\x64\x65" => $code, "\155\163\147" => $error, "\x64\x61\164\141" => $data]; goto eURXT; HiFl5: l7qsB: goto epGzF; Sdll0: $code = 0; goto sw0E2; fNLTQ: $this->getConfig(); goto I_l2a; pT4E8: $code = 1; goto HiFl5; Yq_mh: $ImgStr = implode("\174", $filePath); goto cvWfX; aJbnP: $error = "\344\270\x8a\344\274\240\346\210\x90\xe5\212\237"; goto Z2oyt; Z2oyt: goto l7qsB; goto vtlxk; vtlxk: pt3I2: goto gkcgP; gxvKs: $data = ''; goto rUCkY; RKHph: foreach ($info as $item) { $filePath[] = "\x68\164\164\160\x73\72\57\x2f" . $_SERVER["\x53\105\x52\x56\x45\x52\137\x4e\101\x4d\105"] . __ROOT__ . "\x2f\x50\165\x62\x6c\x69\x63\x2f" . $item["\163\x61\166\145\160\x61\x74\150"] . $item["\163\141\166\145\156\x61\155\x65"]; L1F7f: } goto A0Tqp; I_l2a: $exts = array("\152\x70\x65\x67", "\x6a\160\147", "\152\160\145\147", "\160\156\147", "\x70\x6a\x70\x65\147", "\147\151\146", "\142\155\x70", "\x78\x2d\x70\156\147"); goto BoQzK; A0Tqp: bGB69: goto Yq_mh; sw0E2: $error = ''; goto gxvKs; BoQzK: $upload = new Upload(array("\x6d\x69\155\145\163" => C("\x75\160\x74\x79\x70\145"), "\x65\x78\x74\163" => $exts, "\x72\x6f\157\x74\x50\x61\x74\x68" => "\x2e\x2f\x50\165\142\x6c\151\x63\57", "\x73\x61\x76\145\x50\x61\x74\150" => "\x55\x70\154\157\x61\x64\163\x2f\101\x64\x73\x2f", "\x73\x75\x62\116\141\155\x65" => array("\x64\x61\x74\x65", "\x64"), "\x6d\x61\x78\x53\x69\x7a\145" => C("\155\x61\170\x5f\165\x70\154\x6f\x61\144\x5f\x73\x69\172\x65"))); goto aToD4; gkcgP: $error = $upload->getError(); goto pT4E8; rUCkY: if (!$info) { goto pt3I2; } goto RKHph; eURXT: } private function saveimg($files) { goto nhfIn; BGtNZ: ddOej: goto lI9SI; hCrOV: GGiZp: goto m6xQa; XDBYW: $web = C("\157\x73\163\x5f\167\145\142\137\x73\x69\164\x65"); goto LSR6J; lI9SI: return ["\143\157\x64\x65" => $rs["\143\157\x64\145"], "\x6d\x73\x67" => $rs["\155\x73\147"], "\x64\x61\x74\141" => $rs["\165\x72\x6c"]]; goto RsPio; m6xQa: $rs["\x6d\163\x67"] = "\344\xb8\212\xe4\xbc\xa0\345\x87\xba\xe9\x94\231"; goto BGtNZ; XZxe8: $rs = ossUpPic($fFiles, date("\x59"), $ossClient, $bucketName, $web, 1); goto BtArZ; nhfIn: $bucketName = C("\157\163\163\137\142\x75\x63\153\x65\x74"); goto jsbgl; LSR6J: $fFiles = $_FILES["\x69\155\x67"]; goto XZxe8; pG_K7: $rs["\x6d\163\147"] = "\xe4\xb8\212\xe4\xbc\240\xe6\210\220\345\x8a\237"; goto FB0fq; jsbgl: $ossClient = new \Org\OSS\OssClient(C("\x6f\163\x73\x5f\x61\x63\143\x65\163\x73\137\151\144"), C("\157\x73\163\137\x61\x63\143\145\x73\x73\x5f\153\x65\x79"), C("\157\x73\163\x5f\x65\156\x64\x70\157\151\156\164"), false); goto XDBYW; FB0fq: goto ddOej; goto hCrOV; BtArZ: if ($rs["\x63\x6f\144\x65"]) { goto GGiZp; } goto pG_K7; RsPio: } private function qiniu_saveimg($files) { goto JHL8S; Ea8kD: vendor("\x71\x69\156\151\165\x2e\x73\162\x63\x2e\x51\151\x6e\151\x75\x2e\x41\x75\164\x68"); goto LI_Lk; WbHsC: $token = $auth->uploadToken(C("\x71\x69\x6e\x69\165\137\x62\x75\x63\153\x65\164")); goto H2sDj; HPcX1: goto VQuyL; goto sN9pN; JHL8S: $this->getConfig(); goto GgZyu; o8tgm: return ["\143\157\144\x65" => 1, "\155\163\147" => "\344\270\212\344\xbc\240\xe5\xa4\261\350\264\xa5", "\x64\141\164\141" => '']; goto QYiTo; h1JFV: $auth = new Auth(C("\x71\x69\156\x69\x75\x5f\x61\x6b"), C("\x71\x69\156\151\165\x5f\x73\x6b")); goto WbHsC; IyBl1: $key = date("\131\x6d\144\x48\x69\163") . mt_rand(1, 9) . mt_rand(1, 9) . mt_rand(1, 9) . mt_rand(1, 9) . "\x2e" . $ext[count($ext) - 1]; goto K11q9; sN9pN: PthwA: goto o8tgm; cq6_h: $ext = explode("\56", $_FILES["\151\155\147"]["\156\141\x6d\x65"]); goto IyBl1; TiEKR: if ($err !== null) { goto PthwA; } goto BRuKz; H2sDj: $um = new UploadManager(); goto cq6_h; BRuKz: return ["\x63\x6f\144\x65" => 0, "\x6d\x73\147" => "\xe4\270\x8a\xe4\xbc\240\346\210\x90\345\x8a\237", "\144\x61\164\141" => C("\x71\x69\x6e\151\x75\x5f\163\x69\x74\145") . "\x2f" . $ret["\x6b\x65\171"]]; goto HPcX1; LwGYP: list($ret, $err) = $um->putFile($token, $key, $filePath); goto TiEKR; GgZyu: vendor("\161\x69\156\151\x75\56\141\165\164\157\154\157\x61\x64"); goto Ea8kD; iI16E: vendor("\161\x69\156\151\x75\x2e\163\162\143\x2e\121\x69\156\x69\165\x2e\x5a\x6f\156\x65"); goto h1JFV; K11q9: $filePath = $_FILES["\151\x6d\x67"]["\x74\155\160\137\156\141\x6d\145"]; goto LwGYP; LI_Lk: vendor("\x71\151\x6e\x69\x75\56\163\x72\x63\56\x51\x69\x6e\151\x75\x2e\105\x74\x61\x67"); goto iI16E; QYiTo: VQuyL: goto jttB7; jttB7: } public function batchpic() { goto SlhJi; vAXsh: $ImgStr = implode("\x7c", $Img); goto efumh; efumh: $BackCall = I("\102\141\143\153\103\141\154\x6c"); goto p5xfU; RODIc: T_bZ3: goto bCgkc; gabtB: $this->assign("\111\x6d\x67\123\164\162", $ImgStr); goto bqa9K; W1TpX: $this->assign("\x48\145\x69\147\150\x74", $Height); goto crhUh; CZqK1: eWjVG: goto emgvt; D4FEF: if (C("\x69\x73\x6f\163\163")) { goto T_bZ3; } goto sBg26; qGpM8: $ImgStr = trim($ImgStr, "\x7c"); goto DPVdy; bCgkc: $newImgStr = $this->saveimgs($_FILES); goto gbbQD; DPVdy: $Img = array(); goto K_8sx; cjnnD: $newImgStr = null; goto U7_6m; rd7vB: $this->assign("\x57\x69\x64\164\150", $Width); goto YsxPH; sBg26: $newImgStr = $this->saveimg_local($_FILES); goto G5Ju1; YhcJm: $Height = I("\x48\x65\x69\x67\150\164"); goto wRAly; emgvt: if ($Width) { goto Q5W3Q; } goto iyRx7; R4g_I: jn_vA: goto rd7vB; iyRx7: $Width = $_POST["\127\x69\x64\164\x68"]; goto fJp0q; nS9AW: cKqYv: goto eZQ54; YsxPH: $this->assign("\102\x61\x63\153\103\141\154\154", $BackCall); goto gabtB; hxm41: $Width = $_POST["\x42\141\143\x6b\103\141\154\x6c"]; goto CZqK1; iRvO0: if (!$newImgStr) { goto cKqYv; } goto AFyBP; HMKSr: $Img = explode("\x7c", $ImgStr); goto mRCGq; mRCGq: cGn8o: goto plgje; Ez7v0: $Width = $_POST["\110\x65\x69\x67\x68\x74"]; goto R4g_I; wRAly: if ($BackCall) { goto eWjVG; } goto hxm41; p5xfU: $Width = I("\x75"); goto YhcJm; plgje: $Path = null; goto Ln_kS; bLPl2: $Img = array_merge($Img, $newImg); goto vAXsh; K_8sx: if (!(strlen($ImgStr) > 1)) { goto cGn8o; } goto HMKSr; Ms4Ek: if ($Height) { goto jn_vA; } goto Ez7v0; G5Ju1: goto QLZhy; goto RODIc; bqa9K: $this->assign("\111\155\147", $Img); goto W1TpX; Ln_kS: $newImg = array(); goto cjnnD; AFyBP: $newImg = explode("\x7c", $newImgStr); goto nS9AW; gbbQD: QLZhy: goto iRvO0; U7_6m: if (!$_FILES) { goto Xaq18; } goto D4FEF; SlhJi: $ImgStr = I("\x49\155\147"); goto qGpM8; crhUh: $this->display("\102\141\x74\x63\150\160\x69\x63"); goto pbaeB; eZQ54: Xaq18: goto bLPl2; fJp0q: Q5W3Q: goto Ms4Ek; pbaeB: } private function saveimgs($files) { goto ixqZ0; eeNwF: $web = C("\117\x53\x53\137\x57\x45\102\137\x53\111\124\105"); goto fYOIy; fYOIy: $fFiles = $_FILES["\151\155\147"]; goto HPGJv; f5pXR: JBna_: goto TmC0V; HPGJv: $rs = ossUpPics($fFiles, "\145\x6b\x63\x6d\163", $ossClient, $bucketName, $web, 0); goto qrLsi; wF_iW: goto JBna_; goto AlCcu; NLJz0: echo "\74\163\143\x72\x69\x70\164\x3e\141\x6c\145\162\164\x28\47{$rs["\x6d\163\x67"]}\47\x29\x3c\57\163\x63\162\151\x70\x74\x3e"; goto wF_iW; V1g37: $img = $rs["\x75\x72\154"]; goto tBhCS; mALn9: $ossClient = new \Org\OSS\OssClient(C("\117\x53\123\x5f\x41\x43\103\105\123\x53\137\111\104"), C("\117\x53\x53\137\101\x43\x43\105\x53\123\x5f\113\105\x59"), C("\117\123\x53\x5f\x45\x4e\x44\120\x4f\111\116\x54"), false); goto eeNwF; qrLsi: if ($rs["\143\157\144\145"] == 1) { goto wk00k; } goto NLJz0; AlCcu: wk00k: goto V1g37; ixqZ0: $bucketName = C("\117\x53\x53\137\x42\125\x43\x4b\105\124"); goto mALn9; tBhCS: return $img; goto f5pXR; TmC0V: } public function saveimg_kind() { goto KvNDn; oYTaM: mW1qh: goto OQ2ZQ; C4iqv: goto mW1qh; goto VO6W0; UByhX: $web = C("\x6f\163\163\137\x77\x65\142\x5f\163\x69\164\145"); goto HWXoy; bVLxx: if ($rs["\143\x6f\144\x65"] == 0) { goto meEeV; } goto tl6tJ; VO6W0: meEeV: goto HAdtQ; EGx6M: echo json_encode(array("\145\162\x72\157\162" => 0, "\x75\x72\154" => $img)); goto oYTaM; zVfhC: $ossClient = new \Org\OSS\OssClient(C("\157\x73\x73\x5f\141\x63\x63\x65\163\163\137\x69\x64"), C("\x6f\x73\x73\137\x61\x63\x63\x65\x73\163\137\153\x65\171"), C("\x6f\x73\x73\x5f\145\156\144\160\157\x69\156\x74"), false); goto UByhX; HWXoy: $fFiles = $_FILES["\x69\x6d\x67"]; goto BI8Tw; tl6tJ: echo "\x3c\163\143\x72\151\x70\x74\x3e\x61\x6c\x65\x72\x74\x28\x27{$rs["\155\163\147"]}\x27\51\74\57\x73\x63\x72\151\160\x74\x3e"; goto C4iqv; HAdtQ: $img = $rs["\165\x72\154"]; goto EGx6M; BI8Tw: $rs = ossUpPic($fFiles, "\x79\142\146\170\171\x78", $ossClient, $bucketName, $web, 0); goto bVLxx; KvNDn: $this->getConfig(); goto zj8N1; zj8N1: $files = $_FILES; goto f1Emb; f1Emb: $bucketName = C("\x6f\x73\163\x5f\142\165\x63\x6b\145\x74"); goto zVfhC; OQ2ZQ: } public function qiniu_saveimg_kind() { goto prW8W; JSlbf: Tx_Zt: goto vfQbz; prW8W: $this->getConfig(); goto uSh87; J9e5c: $exts = array("\152\160\145\147", "\152\x70\147", "\x6a\160\x65\147", "\160\x6e\x67", "\x70\152\160\x65\147", "\x67\151\x66", "\142\x6d\160", "\x78\55\x70\x6e\x67"); goto eTw8K; G_Xhj: hBzfC: goto Potdp; gCksO: $filePath = $_FILES["\x69\x6d\x67"]["\x74\155\x70\x5f\x6e\x61\x6d\145"]; goto zPb39; v7h78: exit; goto RbczM; w34GW: $token = $auth->uploadToken(C("\161\x69\156\x69\x75\x5f\x62\165\143\x6b\145\164")); goto qp7CA; NyeNr: echo "\74\163\143\162\151\x70\x74\x3e\x61\154\x65\162\164\50\x27\xe6\226\x87\xe4\273\xb6\xe8\xb6\x85\345\207\272\345\xa4\247\xe5\xb0\x8f\47\51\74\x2f\x73\143\162\151\160\x74\76"; goto fS8Lt; ps0V2: nsj6c: goto v7h78; xK7JK: if (!($fSize > C("\x6d\141\x78\137\x75\160\x6c\x6f\x61\144\137\163\x69\172\145"))) { goto hBzfC; } goto NyeNr; vfQbz: echo "\x3c\x73\x63\162\x69\x70\x74\76\x61\x6c\x65\162\164\x28\x27\344\xb8\212\344\274\xa0\xe5\x87\272\351\224\231\344\272\206\x27\x29\74\57\163\143\162\151\160\x74\76"; goto ps0V2; oFDp6: if ($err !== null) { goto Tx_Zt; } goto jENQH; b2zXi: echo "\x3c\163\143\x72\x69\x70\x74\76\x61\x6c\145\162\164\50\x27\xe6\x96\x87\xe4\xbb\266\346\xa0\274\345\274\217\xe4\270\215\346\255\243\xe7\241\256\47\51\74\57\x73\143\162\151\x70\164\x3e"; goto CQGXZ; Qc5Ry: vendor("\161\151\x6e\151\165\56\x73\x72\143\x2e\121\x69\156\x69\165\x2e\x5a\x6f\x6e\x65"); goto XXBlM; p4Ers: goto nsj6c; goto JSlbf; lcrao: $fSize = $_FILES["\x69\x6d\x67"]["\x73\x69\172\x65"]; goto xK7JK; Potdp: $key = date("\x59\x6d\144\110\x69\163") . mt_rand(1, 9) . mt_rand(1, 9) . mt_rand(1, 9) . mt_rand(1, 9) . "\56" . $ext[count($ext) - 1]; goto gCksO; uXJZ8: vendor("\161\x69\156\x69\165\x2e\x73\x72\x63\x2e\121\151\156\x69\165\56\101\165\x74\x68"); goto ZMjd0; ZMjd0: vendor("\x71\151\x6e\151\165\x2e\x73\x72\143\56\x51\x69\156\x69\165\56\105\164\x61\147"); goto Qc5Ry; fS8Lt: exit; goto G_Xhj; CQGXZ: exit; goto jtJKD; jtJKD: KV6WB: goto lcrao; eTw8K: vendor("\161\151\x6e\151\x75\56\x61\165\164\157\154\x6f\x61\x64"); goto uXJZ8; jENQH: echo json_encode(array("\x65\x72\x72\157\162" => 0, "\x75\162\154" => C("\x71\151\156\151\x75\x5f\163\x69\x74\x65") . "\x2f" . $ret["\153\x65\x79"])); goto p4Ers; GQBHl: if (in_array(strtolower($ext[count($ext) - 1]), $exts)) { goto KV6WB; } goto b2zXi; zPb39: list($ret, $err) = $um->putFile($token, $key, $filePath); goto oFDp6; qp7CA: $um = new UploadManager(); goto SczZf; XXBlM: $auth = new Auth(C("\x71\x69\156\x69\165\x5f\141\153"), C("\161\x69\156\x69\165\x5f\x73\153")); goto w34GW; SczZf: $ext = explode("\x2e", $_FILES["\151\x6d\147"]["\x6e\141\155\145"]); goto GQBHl; uSh87: $mimes = array("\x69\x6d\141\147\x65\x2f\x6a\x70\x65\x67", "\x69\155\141\x67\x65\57\x6a\x70\x67", "\x69\x6d\x61\x67\145\57\x6a\160\145\x67", "\151\155\141\x67\145\x2f\160\156\x67", "\x69\x6d\141\147\x65\57\x70\x6a\160\x65\x67", "\x69\155\141\147\x65\57\147\x69\146", "\x69\x6d\141\x67\145\x2f\x62\x6d\160", "\x69\155\x61\147\x65\57\x78\x2d\160\x6e\x67"); goto J9e5c; RbczM: } public function saveimg_lay() { goto Eg2VV; bgurJ: $ajax["\x64\x61\164\x61"]["\163\162\x63"] = $rs["\165\162\x6c"]; goto jzVb9; jzVb9: $ajax["\144\141\x74\141"]["\164\x69\164\x6c\145"] = ''; goto ZdsLF; dfX14: $ajax["\155\x73\147"] = $rs["\155\163\x67"]; goto idqK3; qXpzt: if ($rs["\143\x6f\x64\x65"] == 1) { goto Tc3rU; } goto Ak5fx; W1L58: $fFiles = $_FILES["\146\x69\x6c\145"]; goto reOX7; Rv4As: $ossClient = new \Org\OSS\OssClient(C("\x6f\x73\163\137\x61\143\143\x65\163\163\x5f\x69\x64"), C("\117\123\x53\x5f\x41\103\103\105\123\x53\x5f\113\x45\x59"), C("\x4f\123\123\137\x45\x4e\104\120\117\x49\x4e\x54"), false); goto mBrAU; MC9Hh: Tc3rU: goto NH13h; ESOuR: $ajax["\155\x73\x67"] = "\344\270\x8a\344\274\xa0\346\210\220\345\212\237"; goto bgurJ; mBrAU: $web = C("\x4f\x53\x53\137\x57\x45\102\x5f\123\x49\x54\105"); goto W1L58; f0d_c: $this->ajaxReturn($ajax); goto xujo4; JRqS6: $bucketName = C("\x4f\x53\123\137\x42\x55\x43\113\x45\x54"); goto Rv4As; reOX7: $rs = ossUpPic($fFiles, "\x65\153\x63\x6d\163", $ossClient, $bucketName, $web, 0); goto qXpzt; ZdsLF: QsUL9: goto f0d_c; NH13h: $ajax["\143\x6f\144\145"] = 0; goto ESOuR; idqK3: goto QsUL9; goto MC9Hh; Ak5fx: $ajax["\143\x6f\144\145"] = 1; goto dfX14; Eg2VV: $files = $_FILES; goto JRqS6; xujo4: } }